(self.webpackChunk_5_112_1332=self.webpackChunk_5_112_1332||[]).push([[1228],{1228:(e,t,i)=>{e.exports=function(e){var t={};function i(s){if(t[s])return t[s].exports;var r=t[s]={exports:{},id:s,loaded:!1};return e[s].call(r.exports,r,r.exports,i),r.loaded=!0,r.exports}return i.m=e,i.c=t,i.p="",i(0)}({0:function(e,t,i){i(1644),e.exports=i(1644)},3:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},20:function(e,t){e.exports=i(1657)},1027:function(e,t){e.exports=i(9839)},1624:function(e,t){e.exports=i(1599)},1644:function(e,t,i){var s,r,n;i(3),r=[i(20),i(1027),i(1645),i(1624)],void 0===(n="function"==typeof(s=function(){!function(e){var t=e.jQuery,i=e.spreadsheet.CellRef,s=".",r={view:"k-spreadsheet-view",fixedContainer:"k-spreadsheet-fixed-container",editContainer:"k-spreadsheet-edit-container",scroller:"k-spreadsheet-scroller",viewSize:"k-spreadsheet-view-size",clipboard:"k-spreadsheet-clipboard",cellEditor:"k-spreadsheet-cell-editor",barEditor:"k-spreadsheet-editor",topCorner:"k-spreadsheet-top-corner",filterHeadersWrapper:"k-filter-wrapper",filterRange:"k-filter-range",filterButton:"k-spreadsheet-filter",filterButtonActive:"k-state-active",horizontalResize:"k-horizontal-resize",verticalResize:"k-vertical-resize",icon:"k-icon",iconFilterDefault:"k-i-arrow-60-down",sheetsBar:"k-spreadsheet-sheets-bar",sheetsBarActive:"k-spreadsheet-sheets-bar-active",sheetsBarInactive:"k-spreadsheet-sheets-bar-inactive",cellContextMenu:"k-spreadsheet-cell-context-menu",rowHeaderContextMenu:"k-spreadsheet-row-header-context-menu",colHeaderContextMenu:"k-spreadsheet-col-header-context-menu",drawingContextMenu:"k-spreadsheet-drawing-context-menu"};function n(e){return(e.size||1)+"px solid "+(e.color||"#000")}function o(e){return/:\/\//.test(e)||(e="http://"+e),e}function a(t,i,s,r){function a(t){var s=i.link;if(s||"object"==typeof i.value&&(s=i.value.link),s){var r={textDecoration:"none"};return i.color&&(r.color=i.color),i.underline&&(r.textDecoration="underline"),e.dom.element("a",{href:o(s),style:r,target:"_blank"},t?[t]:[])}return t}var l=null!=i.value||null!=i.validation&&!i.validation.value||i.background||i.merged||i.comment;if(s||l){var d={},h=i.background;if(h){var c=h;r&&((c=e.parseColor(c).toHSV()).v*=.9,c=c.toCssRgba()),c=n({color:c}),d.outline=c}h&&(d.backgroundColor=h),i.color&&(d.color=i.color),i.fontFamily&&(d.fontFamily=i.fontFamily),i.underline&&(d.textDecoration="underline"),i.italic&&(d.fontStyle="italic"),i.textAlign&&(d.textAlign=i.textAlign),i.bold&&(d.fontWeight="bold"),i.fontSize&&(d.fontSize=i.fontSize+"px"),!0===i.wrap?(d.whiteSpace="pre-wrap",d.overflowWrap="break-word",d.wordWrap="break-word"):(d.whiteSpace="pre",d.overflowWrap="normal",d.wordWrap="normal"),d.left=i.left+1+"px",d.top=i.top+1+"px",d.width=i.width-1+"px",d.height=i.height-1+"px";var p=i.value,f=typeof p,m=i.format;if(m||"number"!=f||p==Math.floor(p)||(m="0.##############"),m&&null!=p?(p=e.spreadsheet.formatting.format(p,m)).__dataType&&(f=p.__dataType):null!=p&&(p=i.html?e.dom.html(p):e.dom.text(p)),!d.textAlign)switch(f){case"number":case"date":case"percent":case"currency":d.textAlign="right";break;case"boolean":d.textAlign="center"}e.spreadsheet.draw.applyIndent(i,d);var g=[u.cell];s&&g.push(s),!1===i.enable&&g.push("k-state-disabled"),i.merged&&g.push("k-spreadsheet-merged-cell"),i.comment&&g.push("k-spreadsheet-has-comment");var v=i.verticalAlign||"bottom",_=(p=v&&p?e.dom.element("div",{className:"k-vertical-align-"+v},[a(p)]):a(p))?[p]:[],w={style:d},b=i.validation;b&&!b.value&&(_.push(e.dom.element("span",{className:"k-dirty"})),g.push("k-dirty-cell"),w.title=b.message),w.className=g.join(" ");var x=e.dom.element("div",w,_);return t.push(x),x}}e.spreadsheet.messages.view={nameBox:"Name Box",errors:{openUnsupported:"Unsupported format. Please select an .xlsx file.",shiftingNonblankCells:"Cannot insert cells due to data loss possibility. Select another insert location or delete the data from the end of your worksheet.",insertColumnWhenRowIsSelected:"Cannot insert column when all columns are selected.",insertRowWhenColumnIsSelected:"Cannot insert row when all rows are selected.",filterRangeContainingMerges:"Cannot create a filter within a range containing merges",sortRangeContainingMerges:"Cannot sort a range containing merges",cantSortMultipleSelection:"Cannot sort multiple selection",cantSortNullRef:"Cannot sort empty selection",cantSortMixedCells:"Cannot sort range containing cells of mixed shapes",validationError:"The value that you entered violates the validation rules set on the cell.",cannotModifyDisabled:"Cannot modify disabled cells.",insertRowBelowLastRow:"Cannot insert row below the last row.",insertColAfterLastCol:"Cannot insert column to the right of the last column."},tabs:{home:"Home",insert:"Insert",data:"Data"}},e.spreadsheet.messages.menus={cut:"Cut",copy:"Copy",paste:"Paste",merge:"Merge",unmerge:"Unmerge",delete:"Delete",hide:"Hide",unhide:"Unhide",bringToFront:"Bring to front",sendToBack:"Send to back"};var l=e.Class.extend({init:function(){this.cols=[],this.trs=[],this._height=0,this._width=0},addColumn:function(t){this._width+=t;var i=e.dom.element("col",{style:{width:t+"px"}});i.visible=t>0,this.cols.push(i)},addRow:function(t){var i;i={style:{height:t+"px"}},this._height+=t;var s=e.dom.element("tr",i);s.visible=t>0,this.trs.push(s)},addCell:function(t,i,s,r,n){null==i&&(i=""),i instanceof e.dom.Node||(i=e.dom.text(i));var o=[i],a={style:s};n&&!n.value&&(o.push(e.dom.element("span",{className:"k-dirty"})),r=(r||"")+(r?" ":"")+"k-dirty-cell",a.title=n.message),r&&(a.className=r);var l=e.dom.element("td",a,o);return this.trs[t].children.push(l),l},toDomTree:function(t,i,s){this.trs=this.trs.filter((function(e){return e.visible}));var r=0;return this.cols=this.cols.filter((function(e,t){return e.visible||(this.trs.forEach((function(e){e.children.splice(t-r,1)})),r++),e.visible}),this),e.dom.element("table",{style:{left:t+"px",top:i+"px",height:this._height+"px",width:this._width+"px"},className:s,role:"presentation"},[e.dom.element("colgroup",null,this.cols),e.dom.element("tbody",null,this.trs)])}});e.spreadsheet.ContextMenu=e.ui.ContextMenu;var d=e.template('<div class="#=classNames.view#"><div class="#=classNames.fixedContainer#"></div><div class="#=classNames.scroller#"><div class="#=classNames.viewSize#"></div></div><div tabindex="0" class="#=classNames.clipboard#" contenteditable=true></div><div class="#=classNames.cellEditor#"></div></div><div class="#=classNames.sheetsBar#"></div><ul class="#=classNames.cellContextMenu#"><li data-action=cut>#: messages.cut #</li><li data-action=copy>#: messages.copy #</li><li data-action=paste>#: messages.paste #</li><li class="k-separator"></li><li data-action=merge>#: messages.merge #</li><li data-action=unmerge>#: messages.unmerge #</li></ul><ul class="#=classNames.rowHeaderContextMenu#"><li data-action=cut>#: messages.cut #</li><li data-action=copy>#: messages.copy #</li><li data-action=paste>#: messages.paste #</li><li class="k-separator"></li><li data-action="delete-row">#: messages.delete #</li><li data-action="hide-row">#: messages.hide #</li><li data-action="unhide-row">#: messages.unhide #</li></ul><ul class="#=classNames.colHeaderContextMenu#"><li data-action=cut>#: messages.cut #</li><li data-action=copy>#: messages.copy #</li><li data-action=paste>#: messages.paste #</li><li class="k-separator"></li><li data-action="delete-column">#: messages.delete #</li><li data-action="hide-column">#: messages.hide #</li><li data-action="unhide-column">#: messages.unhide #</li></ul><ul class="#=classNames.drawingContextMenu#"><li data-action="bring-to-front">#: messages.bringToFront #</li><li data-action="send-to-back">#: messages.sendToBack #</li><li class="k-separator"></li><li data-action="delete-drawing">#: messages.delete #</li></ul>');function h(e,t,i){return e>=t&&e<=i}var c=e.Class.extend({init:function(i,r){var n=c.classNames;this.element=i,this.options=t.extend(!0,{messages:e.spreadsheet.messages.view},this.options,r),this._chrome(),this._dialogs=[],i.append(d({classNames:n,messages:e.spreadsheet.messages.menus})),this._formulaInput(),this.wrapper=i.find(s+n.view),this.container=i.find(s+n.fixedContainer)[0],this.scroller=i.find(s+n.scroller)[0],this.clipboard=i.find(s+n.clipboard),this.viewSize=t(this.scroller.firstChild),this.tree=new e.dom.Tree(this.container),this.clipboardContents=new e.dom.Tree(this.clipboard[0]),this.editor=new e.spreadsheet.SheetEditor(this),this._sheetsbar();var o={target:i,animation:!1,showOn:"never"};this.cellContextMenu=new e.spreadsheet.ContextMenu(i.find(s+n.cellContextMenu),o),this.colHeaderContextMenu=new e.spreadsheet.ContextMenu(i.find(s+n.colHeaderContextMenu),o),this.rowHeaderContextMenu=new e.spreadsheet.ContextMenu(i.find(s+n.rowHeaderContextMenu),o),this.drawingContextMenu=new e.spreadsheet.ContextMenu(i.find(s+n.drawingContextMenu),o)},enableClipboard:function(e){this.isClipboardDeactivated=!e,e?this.clipboard.attr("contenteditable",e):this.clipboard.removeAttr("contenteditable")},_resize:function(){var i=t(this.formulaBar.element).parents(".k-spreadsheet-action-bar"),s=e._outerHeight,r=this.tabstrip?s(this.tabstrip.element):0,n=i?s(i):0,o=this.sheetsbar?s(this.sheetsbar.element):0;this.wrapper.height(this.element.height()-(r+n+o)),this.tabstrip&&this.tabstrip.quickAccessAdjust()},_chrome:function(){var i=t("<div class='k-spreadsheet-action-bar' />").prependTo(this.element),s=t("<div class='k-spreadsheet-name-editor' />").appendTo(i);this.nameEditor=new e.spreadsheet.NameEditor(s,this.options);var r=t("<div />").appendTo(i);this.formulaBar=new e.spreadsheet.FormulaBar(r),this.options.toolbar&&this._tabstrip()},_formulaInput:function(){var t=this.element.find(s+c.classNames.cellEditor);this.formulaInput=new e.spreadsheet.FormulaInput(t,{autoScale:!0})},_sheetsbar:function(){if(this.options.sheetsbar){var i=t.extend(!0,{openDialog:this.openDialog.bind(this)},this.options.sheetsbar);this.sheetsbar=new e.spreadsheet.SheetsBar(this.element.find(s+c.classNames.sheetsBar),i)}},_tabstrip:function(){var i=this.options.messages.tabs,s=t.extend(!0,{home:!0,insert:!0,data:!0},this.options.toolbar),r=[];for(var n in this.tabstrip&&(this.tabstrip.destroy(),this.element.children(".k-tabstrip").remove()),s)(!0===s[n]||s[n]instanceof Array)&&r.push({id:n,text:i[n],content:""});this.tabstrip=new e.spreadsheet.TabStrip(t("<div />").prependTo(this.element),{animation:!1,dataTextField:"text",dataContentField:"content",dataSource:r,toolbarOptions:s,view:this}),this.tabstrip.select(0)},_executeCommand:function(e){this._sheet.trigger("commandRequest",e)},workbook:function(e){this._workbook=e,e._view=this,this.nameEditor._workbook=e},sheet:function(e){this._sheet=e},activeCellRectangle:function(){return this.cellRectangle(this._sheet._viewActiveCell())},_rectangle:function(e,t){return e._grid.boundingRectangle(t.toRangeRef())},isColumnResizer:function(e,t,i){return e-=this._sheet._grid._headerWidth,t._grid.columns.frozen||(e+=this.scroller.scrollLeft),null===(i=this._sheet._grid._columns.locate(0,i,(function(t){return Math.abs(e-t)<=3.5})))||this._sheet.isHiddenColumn(i)?null:i},isRowResizer:function(e,t,i){return e-=this._sheet._grid._headerHeight,t._grid.rows.frozen||(e+=this.scroller.scrollTop),null===(i=this._sheet._grid._rows.locate(0,i,(function(t){return Math.abs(e-t)<=3.5})))||this._sheet.isHiddenRow(i)?null:i},isFilterIcon:function(t,i,s,r){var n=this,o=s._grid,a=o.rows.frozen?0:n.scroller.scrollTop,l=o.columns.frozen?0:n.scroller.scrollLeft;return t-=n._sheet._grid._headerWidth-l,i-=n._sheet._grid._headerHeight-a,e.util.withExit((function(e){n._sheet.forEachFilterHeader(r,(function(r){var o=n._rectangle(s,r);s.filterIconRect(o).intersects(t,i)&&e(!0)}))}))},isAutoFill:function(e,t,i){var s=this._sheet.select();if(s.size>1)return!1;e-=this._sheet._grid._headerWidth,t-=this._sheet._grid._headerHeight,i._grid.columns.frozen||(e+=this.scroller.scrollLeft),i._grid.rows.frozen||(t+=this.scroller.scrollTop);var r=this._rectangle(i,s);return Math.abs(r.right-e)<8&&Math.abs(r.bottom-t)<8},isEditButton:function(e,t,i){if(this._sheet.activeCellCustomEditor()){var s=this.activeCellRectangle();if(t>=s.top&&t<=s.bottom)return i._editorInLastColumn?e<s.left&&e>=s.left-20:e>s.right&&e<=s.right+20}},drawingAt:function(e,t,i){e-=this._sheet._grid._headerWidth,t-=this._sheet._grid._headerHeight,i._grid.columns.frozen||(e+=this.scroller.scrollLeft),i._grid.rows.frozen||(t+=this.scroller.scrollTop);for(var s=this._sheet,r=this._sheet._drawings,n=r.length;--n>=0;){var o=r[n],a=s.drawingBoundingBox(o);if(a.intersects(e,t))return{drawing:o,drx:a.left-e,dry:a.top-t}}},objectAt:function(e,t,s){var r,n,o=this._sheet._grid;if(e<0||t<0||e>this.scroller.clientWidth||t>this.scroller.clientHeight)r={type:"outside"};else if(e<o._headerWidth&&t<o._headerHeight)r={type:"topcorner"};else if(n=this.paneAt(e,t)){if(!s){var a=this.drawingAt(e,t,n);if(a)return{type:"drawing",drawing:a.drawing,drx:a.drx,dry:a.dry,pane:n,startX:e,startY:t}}var l=n._grid.rows.indexVisible(t,this.scroller.scrollTop),d=n._grid.columns.indexVisible(e,this.scroller.scrollLeft),h="cell",c=new i(l,d),u=this._sheet.selectionInProgress();this.isAutoFill(e,t,n)?h="autofill":this.isFilterIcon(e,t,n,c)?h="filtericon":!u&&e<o._headerWidth?(h="rowheader",null!==(l=this.isRowResizer(t,n,l))&&(c=new i(l,-1/0),h="rowresizehandle")):!u&&t<o._headerHeight?(h="columnheader",null!==(d=this.isColumnResizer(e,n,d))&&(c=new i(-1/0,d),h="columnresizehandle")):this.isEditButton(e,t,n)&&(h="editor"),r={type:h,ref:c}}else r={type:"outside"};return r.pane=n,r.x=e,r.y=t,r},paneAt:function(e,t){return this.panes.filter((function(i){var s=i._grid;return h(t,s.top,s.bottom)&&h(e,s.left,s.right)}))[0]},containingPane:function(e){return this.panes.filter((function(t){return!!t._grid.contains(e)}))[0]},cellRectangle:function(e){var t=this.containingPane(e)._grid;return this._sheet._grid.rectangle(e).offset(t.headerWidth-(t.columns.frozen?0:this.scroller.scrollLeft),t.headerHeight-(t.rows.frozen?0:this.scroller.scrollTop))},refresh:function(e){var t=this._sheet;if(this.tabstrip&&this.tabstrip.refreshTools(t.range(t.activeCell())),e.sheetSelection&&this.sheetsbar&&this.sheetsbar.renderSheets(this._workbook.sheets(),this._workbook.sheetIndex(this._sheet)),this._resize(),this.viewSize[0].style.height=t._grid.totalHeight()+"px",this.viewSize[0].style.width=t._grid.totalWidth()+"px",e.layout){var i=t.frozenColumns(),s=t.frozenRows();this.panes=[this._pane(s,i)],i>0&&this.panes.push(this._pane(s,0,null,i)),s>0&&this.panes.push(this._pane(0,i,s,null)),s>0&&i>0&&this.panes.push(this._pane(0,0,s,i))}e.filter&&this._destroyFilterMenu(),e.activeCell&&(this._focus=t.activeCell().toRangeRef())},createFilterMenu:function(i){this._destroyFilterMenu();var s=this._sheet,r=s.filter().ref,n=new e.spreadsheet.Range(r,s),o=t("<div />").appendTo(this.element),a={column:i,range:n},l=new e.spreadsheet.FilterMenu(o,a);return this._filterMenu=l,l},selectClipboardContents:function(){this.isClipboardDeactivated||(this.clipboard.focus(),function(e){var t=window.getSelection();t.removeAllRanges();var i=document.createRange();i.selectNodeContents(e),t.addRange(i)}(this.clipboard[0]))},scrollIntoView:function(e){var t=!1,i=this.containingPane(e)._grid,s=i.scrollBoundaries(e),r=this.scroller,n=i.rows.frozen?0:r.scrollTop,o=i.columns.frozen?0:r.scrollLeft;return s.top<n&&(t=!0,r.scrollTop=s.scrollTop),s.bottom>n&&(t=!0,r.scrollTop=s.scrollBottom),s.left<o&&(t=!0,r.scrollLeft=s.scrollLeft),s.right>o&&(t=!0,r.scrollLeft=s.scrollRight),t},_destroyDialog:function(){this._dialogs.pop()},openCustomEditor:function(){var e=this,t=e._sheet.activeCell().first(),i=e._sheet.activeCellCustomEditor(),s=e._sheet.range(t);i.edit({range:s,rect:e.activeCellRectangle(),view:this,validation:this._sheet.validation(t),callback:function(t,i){e._executeCommand({command:"EditCommand",options:{operatingRange:s,editRange:s,property:i?"input":"value",value:t}})}})},openDialog:function(t,i){var s=this._sheet;return s.withCultureDecimals(function(){var r=e.spreadsheet.dialogs.create(t,i);if(r){r.bind("action",this._executeCommand.bind(this)),r.bind("deactivate",this._destroyDialog.bind(this)),this._dialogs.push(r);var n=s.activeCell(),o=new e.spreadsheet.Range(n,s);return r.open(o),r}}.bind(this))},showError:function(i,s){var r=this._dialogs,n=this.options.messages.errors,o=!1;if(r.length>0&&r.forEach((function(e){e.options&&"Error"===e.options.title&&(o=!0)})),!o){var a=function(t){var i=t.sender.dialog().element;i.find(".k-button:first").focus(),i.find(".k-button, input").on("keydown",(function(i){i.keyCode==e.keys.ESC&&t.sender.close()}))},l=function(e){var t=e.sender;this.selectClipboardContents(),t._retry&&s&&s()}.bind(this);if(e.spreadsheet.dialogs.registered(i.type)){var d={close:l};"validationError"===i.type&&(d=t.extend(d,{title:i.title||"Error",text:i.body?i.body:n[i.type],activate:a})),this.openDialog(i.type,d)}else this.openDialog("message",{title:i.title||"Error",text:i.body?i.body:n[i.type],activate:a,close:l})}},destroy:function(){this._dialogs.forEach((function(e){e.destroy()})),this.cellContextMenu.destroy(),this.rowHeaderContextMenu.destroy(),this.colHeaderContextMenu.destroy(),this.drawingContextMenu.destroy(),this.cellContextMenu=this.rowHeaderContextMenu=this.colHeaderContextMenu=this.drawingContextMenu=null,this.tabstrip&&(this.tabstrip.destroy(),this.tabstrip=null),this._destroyFilterMenu()},_destroyFilterMenu:function(){this._filterMenu&&(this._filterMenu.destroy(),this._filterMenu=void 0,this._filterMenuColumn=void 0)},render:function(i){if(this.element.is(":visible")){var s=this._sheet,n=s.focus(),o=e.support.scrollbar(),a=this.wrapper[0].clientWidth-o,l=this.wrapper[0].clientHeight-o;if(!n||!this.scrollIntoView(n)){var d=s.resizingInProgress()?s.resizeHandlePosition().col===-1/0?"column":"row":"none";this.wrapper.toggleClass(r.editContainer,this.editor.isActive()).toggleClass(r.horizontalResize,"row"==d).toggleClass(r.verticalResize,"column"==d);var h=s._grid,u=[],p={scroller:this.scroller,toplevelElements:u,contentWidth:a,contentHeight:l};this.panes.forEach((function(e){u.push(e.render(p))}));var f=e.dom.element("div",{style:{width:h._headerWidth+"px",height:h._headerHeight+"px"},className:c.classNames.topCorner});u.push(f),s.resizeHandlePosition()&&s.resizeHintPosition()&&u.push(this.renderResizeHint()),this.tree.render(u),t(this.container).css({width:a,height:l}),this.editor.isActive()?this.editor.toggleTooltip(this.activeCellRectangle()):i.resize||i.comment||s.selectionInProgress()||s.resizingInProgress()||s.draggingInProgress()||s.isInEditMode()||this.renderClipboardContents()}}},renderResizeHint:function(){var t,i=this._sheet,s=i.resizeHandlePosition().col!==-1/0;t=s?{height:this.scroller.clientHeight+"px",width:"7px",left:i.resizeHintPosition().x+"px",top:"0px"}:{height:"7px",width:this.scroller.clientWidth+"px",top:i.resizeHintPosition().y+"px",left:"0px"};var r=p.classNames;return e.dom.element("div",{className:r.resizeHint+(s?"":" "+r.resizeHintVertical),style:t},[e.dom.element("div",{className:r.resizeHintHandle}),e.dom.element("div",{className:r.resizeHintMarker})])},renderClipboardContents:function(){var t=this._sheet,s=t._grid,r=s.normalize(t.select().toRangeRef()),o=this._workbook.clipboard().canCopy();if(!1===o.canCopy&&o.multiSelection)return this.clipboardContents.render([]),void this.selectClipboardContents();r=t.trim(r);var a=new l,d=s.rangeDimensions(r);d.rows.forEach((function(e){a.addRow(e)})),d.columns.forEach((function(e){a.addColumn(e)}));var h=t._getMergedCells(r),c=h.primary,u=h.secondary;t.forEach(r,(function(t,s,o){var l=new i(t,s).print();if(!u[l]){var d=function(t,i,s){var r={};s.background&&(r.backgroundColor=s.background),s.color&&(r.color=s.color),s.fontFamily&&(r.fontFamily=s.fontFamily),s.underline&&(r.textDecoration="underline"),s.italic&&(r.fontStyle="italic"),s.textAlign&&(r.textAlign=s.textAlign),s.verticalAlign&&(r.verticalAlign="center"===s.verticalAlign?"middle":s.verticalAlign),s.bold&&(r.fontWeight="bold"),s.fontSize&&(r.fontSize=s.fontSize+"px"),!0===s.wrap&&(r.whiteSpace="pre-wrap"),s.borderRight?r.borderRight=n(s.borderRight):s.background&&(r.borderRightColor=s.background),s.borderBottom?r.borderBottom=n(s.borderBottom):s.background&&(r.borderBottomColor=s.background);var o=s.value,a=typeof o,l=s.format;if(l||"number"!=a||o==Math.floor(o)||(l="0.##############"),l&&null!=o&&(o=e.spreadsheet.formatting.format(o,l)).__dataType&&(a=o.__dataType),!r.textAlign)switch(a){case"number":case"date":case"percent":case"currency":r.textAlign="right";break;case"boolean":r.textAlign="center"}var d=null;!1===s.enable&&(d="k-state-disabled");var h,c,u=t.addCell(i,o,r,d,s.validation);return s.borderLeft?(c=function(e,t){var i=e.trs[t].children;return i[i.length-2]}(t,i),h=n(s.borderLeft),c&&h&&(c.attr.style.borderRight=h)):s.background&&(r.borderLeftColor=s.background),s.borderTop?(c=function(e,t){var i=e.trs[t-1],s=e.trs[t].children.length-1;if(i&&s>=0)return i.children[s]}(t,i),h=n(s.borderTop),c&&h&&(c.attr.style.borderBottom=h)):s.background&&(r.borderTopColor=s.background),u}(a,t-r.topLeft.row,o),h=c[l];h&&(d.attr.colspan=h.width(),d.attr.rowspan=h.height())}})),e.support.browser.msie&&this.clipboard.empty(),this.clipboardContents.render([a.toDomTree(0,0,"kendo-clipboard-"+this._workbook.clipboard()._uid)]),this.selectClipboardContents()},_pane:function(e,t,i,s){var r=new p(this._sheet,this._sheet._grid.pane({row:e,column:t,rowCount:i,columnCount:s}));return r.refresh(this.scroller.clientWidth,this.scroller.clientHeight),r}}),u={cell:"k-spreadsheet-cell",vaxis:"k-spreadsheet-vaxis",haxis:"k-spreadsheet-haxis",vborder:"k-spreadsheet-vborder",hborder:"k-spreadsheet-hborder",rowHeader:"k-spreadsheet-row-header",columnHeader:"k-spreadsheet-column-header",pane:"k-spreadsheet-pane",data:"k-spreadsheet-data",mergedCell:"k-spreadsheet-merged-cell",mergedCellsWrapper:"k-merged-cells-wrapper",activeCell:"k-spreadsheet-active-cell",selection:"k-spreadsheet-selection",selectionWrapper:"k-selection-wrapper",autoFillWrapper:"k-auto-fill-wrapper",single:"k-single",top:"k-top",right:"k-right",bottom:"k-bottom",left:"k-left",resizeHandle:"k-resize-handle",columnResizeHandle:"k-column-resize-handle",rowResizeHandle:"k-row-resize-handle",resizeHint:"k-resize-hint",resizeHintHandle:"k-resize-hint-handle",resizeHintMarker:"k-resize-hint-marker",resizeHintVertical:"k-resize-hint-vertical",selectionHighlight:"k-spreadsheet-selection-highlight",series:["k-series-a","k-series-b","k-series-c","k-series-d","k-series-e","k-series-f"]},p=e.Class.extend({init:function(e,t){this._sheet=e,this._grid=t},refresh:function(e,t){this._grid.refresh(e,t)},isVisible:function(e,t,i){return this._grid.view(e,t).ref.intersects(i)},render:function(t){var i=t.scroller,s=i.scrollLeft,r=i.scrollTop;r<0&&(r=0),s<0&&(s=0);var n=p.classNames,o=this._sheet,a=this._grid,l=a.view(s,r);this._currentView=l,this._currentRect=this._rectangle(l.ref),this._selectedHeaders=o.selectedHeaders();var d=[];if(d.push(this.renderData(t)),o._activeDrawing||d.push(this.renderSelection(i)),d.push(this.renderAutoFill()),d.push(this.renderEditorSelection()),d.push(this.renderFilterHeaders()),a.hasRowHeader){var h=e.dom.element("div",{className:n.rowHeader,style:{width:a.headerWidth+"px",top:l.rowOffset+"px"}});d.push(h),o.forEach(l.ref.leftColumn(),function(t){if(!o.isHiddenRow(t)){var i=t+1,s=o.rowHeight(t);h.children.push(e.dom.element("div",{className:this.headerClassName(t,"row"),style:{width:a.headerWidth+"px",height:s+"px"}},[e.dom.element("div",{className:"k-vertical-align-center"},[e.dom.text(i+"")])]))}}.bind(this))}if(a.hasColumnHeader){var c=e.dom.element("div",{className:n.columnHeader,style:{top:"0px",left:l.columnOffset+"px",width:this._currentRect.width+"px",height:a.headerHeight+"px"}});d.push(c);var u=0;o.forEach(l.ref.topRow(),function(t,i){if(!o.isHiddenColumn(i)){var s=e.spreadsheet.Ref.display(null,1/0,i),r=o.columnWidth(i);c.children.push(e.dom.element("div",{className:this.headerClassName(i,"col"),style:{position:"absolute",left:u+"px",width:r+"px",height:a.headerHeight+"px"}},[e.dom.element("div",{className:"k-vertical-align-center"},[e.dom.text(s+"")])])),u+=r}}.bind(this))}o.resizeHandlePosition()&&(a.hasColumnHeader||a.hasRowHeader)&&(o.resizeHintPosition()||this.renderResizeHandle(d));var f=[n.pane];return a.hasColumnHeader&&f.push(n.top),a.hasRowHeader&&f.push(n.left),e.dom.element("div",{style:a.style,className:f.join(" ")},d)},headerClassName:function(e,t){var i,s,r=this._selectedHeaders;"row"===t?(i=r.rows[e],s=r.allRows):(i=r.cols[e],s=r.allCols);var n=i||(r.all?"full":s?"partial":"none");return n&&(n="k-selection-"+n),n},renderData:function(t){var i,s=this._sheet,r=this._currentView,n=e.dom.element("div",{className:p.classNames.data,style:{position:"relative",left:r.columnOffset+"px",top:r.rowOffset+"px"}}),o=this._currentRect,l=e.spreadsheet.draw.doLayout(s,r.ref,{forScreen:!0}),d=this._grid,h=s._showGridLines;h&&(i=null,l.xCoords.forEach((function(t){t!==i&&(i=t,n.children.push(e.dom.element("div",{className:u.vaxis,style:{left:t+"px",height:o.height+"px",borderColor:s.gridLinesColor()}})))})),i=null,l.yCoords.forEach((function(t){t!==i&&(i=t,n.children.push(e.dom.element("div",{className:u.haxis,style:{top:t+"px",width:o.width+"px",borderColor:s.gridLinesColor()}})))})));var c=e.spreadsheet.draw.Borders(),f=s.activeCell().toRangeRef(),m=f.topLeft;return l.cells.forEach((function(i){var o=null,l=i.row+r.ref.topLeft.row,u=i.col+r.ref.topLeft.col;if(s._activeDrawing){var g=s._activeDrawing.topLeftCell;g&&g.row==l&&g.col==u&&(o="k-spreadsheet-drawing-anchor-cell")}else l==m.row&&u==m.col&&(o=[p.classNames.activeCell].concat(this._activeFormulaColor(),this._directionClasses(f)),s.singleCellSelection()&&o.push(p.classNames.single),o=o.join(" "));if(c.add(i),a(n.children,i,o,h),i.comment&&s._commentRef&&l==s._commentRef.row&&u==s._commentRef.col){var v=i.right+d.left+r.columnOffset+4,_={top:i.top+d.top+r.rowOffset+"px"};v+200>t.contentWidth?_.right=t.contentWidth-d.left-i.left-r.columnOffset+4+"px":_.left=v+"px";var w=e.dom.element("div",{className:"k-tooltip k-spreadsheet-cell-comment",style:_},[e.dom.text(i.comment)]);t.toplevelElements.push(w)}}),this),c.vert.forEach((function(t){t.forEach((function(t){if(!t.rendered){t.rendered=!0;var i={left:t.x+"px",top:t.top+"px",height:t.bottom-t.top+1+"px",borderWidth:t.size+"px",borderColor:t.color};1!=t.size&&(i.transform="translateX(-"+(t.size-1)/2+"px)"),n.children.push(e.dom.element("div",{className:u.vborder,style:i}))}}))})),c.horiz.forEach((function(t){t.forEach((function(t){if(!t.rendered){t.rendered=!0;var i={top:t.y+"px",left:t.left+"px",width:t.right-t.left+"px",borderWidth:t.size+"px",borderColor:t.color};1!=t.size&&(i.transform="translateY(-"+(t.size-1)/2+"px)"),n.children.push(e.dom.element("div",{className:u.hborder,style:i}))}}))})),this.renderDrawings(l,n.children),n},renderDrawings:function(t,i){var s=this._sheet,r=s._workbook;t.drawings.forEach((function(t){var n=t.drawing,o=t.box.toDiv("k-spreadsheet-drawing");n.image&&o.children.push(e.dom.element("div",{className:"k-spreadsheet-drawing-image",style:{backgroundImage:"url('"+r.imageUrl(n.image)+"')",opacity:n.opacity}})),n===s._activeDrawing&&(o.attr.className+=" k-spreadsheet-active-drawing",function(t){["N","NE","E","SE","S","SW","W","NW"].forEach((function(i){t.push(e.dom.element("div",{className:"k-spreadsheet-drawing-handle "+i,"data-direction":i}))}))}(o.children)),i.push(o)}))},renderResizeHandle:function(t){var i,s=this._sheet.resizeHandlePosition(),n=this._rectangle(s),o=[p.classNames.resizeHandle];if(s.col!==-1/0){if(this._grid.rows._start>0)return;i={height:this._grid.headerHeight+"px",width:"7px",left:n.right-3.5+"px",top:"0px"},o.push(r.horizontalResize)}else{if(this._grid.columns._start>0)return;i={height:"7px",width:this._grid.headerWidth+"px",top:n.bottom-3.5+"px",left:"0px"},o.push(r.verticalResize)}t.push(e.dom.element("div",{className:o.join(" "),style:i}))},filterIconRect:function(t){return new e.spreadsheet.Rectangle(t.right-16-3,t.top+3,16,16)},renderFilterHeaders:function(){var t=this._sheet,i=[],s=c.classNames,r=t.filter();function n(t){return e.dom.element("span",{className:s.icon+" "+t})}return r&&this._addDiv(i,r.ref,s.filterRange),t.forEachFilterHeader(this._currentView.ref,function(t){var o=this._rectangle(t),a=this.filterIconRect(o),l=this._sheet.filterColumn(t),d=function(t,i,s){var o={left:i.left+"px",top:i.top+"px"},a=r&&r.columns.some((function(e){return e.index===s})),l=t.filterButton;return a&&(l+=" "+t.filterButtonActive),e.dom.element("span",{className:l,style:o},[n(t.iconFilterDefault)])}(s,a,l);i.push(d)}.bind(this)),e.dom.element("div",{className:s.filterHeadersWrapper},i)},renderEditorSelection:function(){var t=p.classNames,i=this._sheet,s=[];return i._formulaSelections.forEach(function(i){var r=i.ref;r!==e.spreadsheet.NULLREF&&this._addDiv(s,r,t.selectionHighlight+" "+i.colorClass)}.bind(this)),e.dom.element("div",{className:t.selectionWrapper},s)},renderSelection:function(t){var i=p.classNames,s=[],r=[i.selection],n=this._sheet,o=n.activeCell().toRangeRef(),a=n.select();return r=r.concat(this._activeFormulaColor()),1===a.size()&&r.push("k-single-selection"),this._sheet.autoFillPunch()&&r.push("k-dim-auto-fill-handle"),a.forEach(function(t){t!==e.spreadsheet.NULLREF&&this._addDiv(s,t,r.join(" "))}.bind(this)),this._renderCustomEditorButton(s,o,t),e.dom.element("div",{className:i.selectionWrapper},s)},renderAutoFill:function(){var t=[];if(this._sheet.autoFillInProgress()){var s=this._sheet.autoFillRef(),r=this._sheet.autoFillPunch(),n=this._sheet._autoFillDirection;if(this._addDiv(t,s,"k-auto-fill"),r)this._addDiv(t,r,"k-auto-fill-punch");else if(void 0!==n){var o,a;switch(n){case 0:case 1:o=s.bottomRight,a="k-auto-fill-br-hint";break;case 2:o=new i(s.topLeft.row,s.bottomRight.col),a="k-auto-fill-tr-hint";break;case 3:o=new i(s.bottomRight.row,s.topLeft.col),a="k-auto-fill-bl-hint"}var l=this._addDiv(t,o,a);if(l){var d=e.dom.element("span",{className:"k-tooltip"},[e.dom.text(this._sheet._autoFillHint)]);l.children.push(d)}}}return e.dom.element("div",{className:p.classNames.autoFillWrapper},t)},_addDiv:function(e,t,i){var s;return this._currentView.ref.intersects(t)&&(s=this._rectangle(t).resize(1,1).toDiv(i),e.push(s)),s},_renderCustomEditorButton:function(t,i,s){var r=this,n=r._sheet,o=r._currentView,a=r._grid.columns._axis._count,l=n.activeCellCustomEditor();if(l&&o.ref.intersects(i)){var d=r._rectangle(i);n.forEach(i.collapse(),(function(i,n,o){o.left=d.left,o.top=d.top,o.width=d.width,o.height=d.height;var h="k-button k-spreadsheet-editor-button",c=n==a-1||r._buttonOutOfVisiblePane(i,n,s);c&&(h+=" k-spreadsheet-last-column"),r._editorInLastColumn=c;var u=e.dom.element("div",{className:h,style:{left:o.left+(c?0:o.width)+"px",top:o.top+"px",height:o.height+"px"}});l.icon&&u.children.push(e.dom.element("span",{className:"k-icon "+l.icon})),t.push(u)}))}},_activeFormulaColor:function(){var e,t=[];return this._sheet.isInEditMode()&&(e=this._sheet._formulaSelections.filter((function(e){return e.active&&"ref"==e.type}))[0])&&t.push(e.colorClass),t},_directionClasses:function(e){var t=[],i=p.classNames,s=this._currentView.ref;return e.move(0,-1).intersects(s)||t.push(i.left),e.move(-1,0).intersects(s)||t.push(i.top),e.move(0,1).intersects(s)||t.push(i.right),e.move(1,0).intersects(s)||t.push(i.bottom),t},_rectangle:function(e){return this._grid.boundingRectangle(e.toRangeRef()).offset(-this._currentView.mergedCellLeft,-this._currentView.mergedCellTop)},_buttonOutOfVisiblePane:function(e,t,i){var s=this._grid,r=this._sheet,n=r.range(e,t)._ref,o=s.scrollBoundaries(n),a=s.columns.frozen?0:i.scrollLeft;if(o.right+20>a||t+1===r.frozenColumns())return!0}});e.spreadsheet.View=c,e.spreadsheet.Pane=p,e.spreadsheet.drawCell=a,t.extend(!0,c,{classNames:r}),t.extend(!0,p,{classNames:u})}(window.kendo)})?s.apply(t,r):s)||(e.exports=n)},1645:function(e,t){e.exports=i(6600)}})}}]);