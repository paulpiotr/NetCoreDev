(self.webpackChunk_5_112_1332=self.webpackChunk_5_112_1332||[]).push([[667],{667:(e,t,a)=>{e.exports=function(e){var t={};function a(i){if(t[i])return t[i].exports;var n=t[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,a),n.loaded=!0,n.exports}return a.m=e,a.c=t,a.p="",a(0)}({0:function(e,t,a){e.exports=a(1458)},3:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},1048:function(e,t){e.exports=a(4869)},1049:function(e,t){e.exports=a(1657)},1458:function(e,t,a){var i,n,o;(function(r){a(3),n=[a(1049)],void 0===(o="function"==typeof(i=function(){return function(e,t){var a=window.kendo,i=a.ui.Widget,n=a.antiForgeryTokens,o=a.logToConsole,s=/\.([^\.]+)$/,l=".kendoUpload",p="select",d="upload",u="success",c="error",f="complete",h="cancel",m="clear",k="pause",v="resume",g="progress",_="remove",y="invalidMaxFileSize",F="invalidMinFileSize",w="invalidFileExtension",C="k-i-upload",z="k-i-warning",S="k-i-check",U=i.extend({init:function(t,n){var o=this;i.fn.init.call(o,t,n),o.name=t.name,o.multiple=o.options.multiple,o.directory=o.options.directory,o.localization=o.options.localization;var r=o.element;o.wrapper=r.closest(".k-upload"),0===o.wrapper.length&&(o.wrapper=o._wrapInput(r)),o._activeInput(r),o.toggle(o.options.enabled);var s=o._ns=l+"-"+a.guid();r.closest("form").on("submit"+s,e.proxy(o._onParentFormSubmit,o)).on("reset"+s,e.proxy(o._onParentFormReset,o)),o._initUploadModule(),o._toggleDropZone(),o.wrapper.on("click",".k-upload-action",e.proxy(o._onFileAction,o)).on("click",".k-clear-selected",e.proxy(o._onClearSelected,o)).on("click",".k-upload-selected",e.proxy(o._onUploadSelected,o)),o.element.val()&&o._onInputChange({target:o.element})},events:[p,d,u,c,f,h,m,g,_,k,v],options:{name:"Upload",enabled:!0,multiple:!0,directory:!1,showFileList:!0,template:"",files:[],async:{autoRetryAfter:0,bufferChunkSize:1e7,maxAutoRetries:1,removeVerb:"POST",autoUpload:!0,withCredentials:!0,accept:"*/*; q=0.5, application/json",useArrayBuffer:!1},localization:{select:"Select files...",cancel:"Cancel",retry:"Retry",remove:"Remove",pause:"Pause",resume:"Resume",clearSelectedFiles:"Clear",uploadSelectedFiles:"Upload",dropFilesHere:"Drop files here to upload",invalidFiles:"Invalid file(s). Please check file upload requirements.",statusUploading:"uploading",statusUploaded:"uploaded",statusWarning:"warning",statusFailed:"failed",headerStatusUploading:"Uploading...",headerStatusPaused:"Paused",headerStatusUploaded:"Done",uploadSuccess:"File(s) uploaded successfully.",uploadFail:"File(s) failed to upload.",invalidMaxFileSize:"File size too large.",invalidMinFileSize:"File size too small.",invalidFileExtension:"File type not allowed."},validation:{allowedExtensions:[],maxFileSize:0,minFileSize:0},dropZone:""},_initUploadModule:function(){var e=this,t=e.options;if(t.async.saveUrl){e._module=e._supportsFormData()?new E(e):new x(e),e._async=!0;var a=t.files;a.length>0&&e._renderInitialFiles(a)}else e._module=new b(e)},setOptions:function(t){var a=this,n=a.element;e(a.options.dropZone).off(a._ns),i.fn.setOptions.call(a,t),a.multiple=a.options.multiple,a.directory=a.options.directory,n.attr("multiple",!!a._supportsMultiple()&&a.multiple),a.directory&&(n.attr("webkitdirectory",a.directory),n.attr("directory",a.directory)),a.toggle(a.options.enabled),a._initUploadModule(),a._toggleDropZone()},enable:function(e){e=void 0===e||e,this.toggle(e)},disable:function(){this.toggle(!1)},toggle:function(e){e=void 0===e?e:!e,this.wrapper.toggleClass("k-state-disabled",e),this.element.prop("disabled",e)},focus:function(){this.element.focus()},destroy:function(){var t=this,a=e(t.options.dropZone);e(document).add(e(".k-dropzone",t.wrapper)).add(t.wrapper.closest("form")).off(t._ns),a.length>0&&a.off(t._ns),e(t.element).off(l),i.fn.destroy.call(t)},pause:function(t){this._module.onPause({target:e(t,this.wrapper)});var a=t.find(".k-i-pause-sm");a.removeClass("k-i-pause-sm").addClass("k-i-play-sm").attr("title",this.localization.resume),e(a).parent().attr("aria-label",this.localization.resume)},resume:function(t){this._module.onResume({target:e(t,this.wrapper)});var a=t.find(".k-i-play-sm");a.removeClass("k-i-play-sm").addClass("k-i-pause-sm").attr("title",this.localization.pause),e(a).parent().attr("aria-label",this.localization.pause)},upload:function(){this._module.onSaveSelected()},getFiles:function(){for(var t,a=[],i=this.wrapper.find(".k-file"),n=0;n<i.length;n++)if(t=e(i[n]).data("fileNames"))for(var o=0;o<t.length;o++)a.push(t[o]);return a},clearAllFiles:function(){var e=this;e.wrapper.find(".k-file").each((function(t,a){e._removeFileByDomElement(a,!1)}))},removeAllFiles:function(){var e=this;e.wrapper.find(".k-file").each((function(t,a){e._removeFileByDomElement(a,!0)}))},removeFileByUid:function(e){this._removeFileByUid(e,!0)},clearFileByUid:function(e){this._removeFileByUid(e,!1)},_removeFileByUid:function(t,i){var n;"string"==typeof t&&(n=e(".k-file["+a.attr("uid")+'="'+t+'"]',this.wrapper)).length>0&&this._removeFileByDomElement(n,i)},clearFile:function(e){this._removeFile(e,!1)},removeFile:function(e){this._removeFile(e,!0)},_removeFile:function(t,a){var i,n=this,o=n.wrapper.find(".k-file");"function"==typeof t&&o.each((function(o,r){i=e(r).data("fileNames"),t(i)&&n._removeFileByDomElement(r,a)}))},_removeFileByDomElement:function(t,a){var i=this,n={target:e(t,i.wrapper)};i.options.async.saveUrl?(e(t).hasClass("k-file-progress")?i._module.onCancel(n):i._module.onRemove(n,{},a),0===e(".k-file",i.wrapper).length?i._hideHeaderUploadstatus():i._updateHeaderUploadStatus()):i._module.onRemove(n,{},a)},_addInput:function(t){if(t[0].nodeType){var a=this,i=t.clone().val("");i.insertAfter(a.element).data("kendo"+a.options.prefix+a.options.name,a),e(a.element).hide().attr("tabindex","-1").removeAttr("id").off(l),a._activeInput(i),a.element.focus()}},_activeInput:function(t){var a=this,i=a.wrapper;a.element=t,a.directory&&(t.attr("webkitdirectory",a.directory),t.attr("directory",a.directory)),t.attr("multiple",!!a._supportsMultiple()&&a.multiple).attr("autocomplete","off").on("click"+l,(function(e){i.hasClass("k-state-disabled")&&e.preventDefault()})).on("focus"+l,(function(){e(this).parent().addClass("k-state-focused")})).on("blur"+l,(function(){e(this).parent().removeClass("k-state-focused")})).on("change"+l,e.proxy(a._onInputChange,a)).on("keydown"+l,e.proxy(a._onInputKeyDown,a))},_onInputKeyDown:function(e){var t=this.wrapper.find(".k-upload-action:visible:first");e.keyCode===a.keys.TAB&&t.length>0&&!e.shiftKey&&(e.preventDefault(),t.focus())},_onInputChange:function(t){var a=this,i=e(t.target),n=P(a._inputFiles(i),a._isAsyncNonBatch());T(n,a.options.validation),a.trigger(p,{files:n})?(a._addInput(i),i.remove()):a._module.onSelect({target:i},n)},_readDirectory:function(t){var a=new e.Deferred,i=t.createReader(),n=[],o=function(){i.readEntries((function(e){e.length?(n=n.concat(e),o()):a.resolve(n)}),a.reject)};return o(),a.promise()},_readFile:function(e){var t=this,a=e.fullPath;e.file((function(e){e.relativePath=a.slice(1),t.droppedFolderFiles.push(e),t.droppedFolderCounter--,0===t.droppedFolderCounter&&setTimeout((function(){0===t.droppedFolderCounter&&t.droppedFolderFiles.length&&(t._proceedDroppedItems(t.droppedFolderFiles),t.droppedFolderFiles=[])}),0)}),(function(){o("File error.")}))},_traverseFileTree:function(e,t){var a=this;t||a.droppedFolderCounter--,this._readDirectory(e).then((function(e){a.droppedFolderCounter+=e.length;for(var t=0;t<e.length;t++)e[t].isFile?a._readFile(e[t]):e[t].isDirectory&&a._traverseFileTree(e[t])}))},_onDrop:function(e){var t,a=e.originalEvent.dataTransfer,i=this,n=a.files;if(Z(e),i.options.directoryDrop&&a.items){t=a.items.length,i.droppedFolderCounter=0,i.droppedFolderFiles=[];for(var o=0;o<t;o++)if(a.items[o].webkitGetAsEntry){var r=a.items[o].webkitGetAsEntry();r.isDirectory?i._traverseFileTree(r,!0):r.isFile&&i.droppedFolderFiles.push(a.files[o])}else i._proceedDroppedItems(n)}else i._proceedDroppedItems(n)},_proceedDroppedItems:function(t){var a=this,i=P(R(t),a._isAsyncNonBatch());t.length>0&&!a.wrapper.hasClass("k-state-disabled")&&(!a.multiple&&i.length>1&&i.splice(1,i.length-1),T(i,a.options.validation),a.trigger(p,{files:i})||a._module.onSelect({target:e(".k-dropzone",a.wrapper)},i))},_filesContainValidationErrors:function(t){var a=!1;return e(t).each((function(e,t){if(t.validationErrors&&t.validationErrors.length>0)return a=!0,!1})),a},_isAsyncNonBatch:function(){return this._async&&!this.options.async.batch||!1},_renderInitialFiles:function(e){var t=this,a=0;for(e=P(e,!0),a=0;a<e.length;a++){var i=e[a],n=t._enqueueFile(i.name,{fileNames:[i]});n.addClass("k-file-success").data("files",[e[a]]),t._supportsRemove()&&t._fileAction(n,_)}},_prepareTemplateData:function(e,t){var a=t.fileNames,i={},n=0,o=0;for(o=0;o<a.length;o++)n+=a[o].size;return i.name=e,i.size=n,i.files=t.fileNames,i},_prepareDefaultSingleFileEntryTemplate:function(t){var i=t.fileNames[0],n=H(t.fileNames),o=a.getFileGroup(i.extension,!0),r=i.validationErrors,s="";return r&&r.length>0?s+="<li class='k-file k-file-invalid'><div class='k-progressbar k-hidden'><span class='k-progress'></span></div><span class='k-file-invalid-group-wrapper'><span class='k-file-group k-icon k-i-"+o+"'></span><span class='k-file-state'></span></span><span class='k-file-name-size-wrapper'><span class='k-file-name k-file-name-invalid' title='"+i.name+"'>"+i.name+"</span><span class='k-file-validation-message k-text-error'>"+this.localization[r[0]]+"</span></span>":s+="<li class='k-file'><div class='k-progressbar k-hidden'><span class='k-progress'></span></div><span class='k-file-group-wrapper'><span class='k-file-group k-icon k-i-"+o+"'></span><span class='k-file-state'></span></span><span class='k-file-name-size-wrapper'><span class='k-file-name' title='"+i.name+"'>"+i.name+"</span><span class='k-file-size'>"+n+"</span></span>",e(s+="<strong class='k-upload-status'></strong>")},_prepareDefaultMultipleFileEntriesTemplate:function(t){var a,i,n=t.fileNames,o=this._filesContainValidationErrors(n),r=H(n),s="";for(s+=o?"<li class='k-file k-file-invalid'><div class='k-progressbar k-hidden'><span class='k-progress'></span></div><span class='k-multiple-files-invalid-group-wrapper'><span class='k-file-group k-icon k-i-files'></span>":"<li class='k-file'><div class='k-progressbar k-hidden'><span class='k-progress'></span></div><span class='k-multiple-files-group-wrapper'><span class='k-file-group k-icon k-i-files'></span>",s+="<span class='k-file-state'></span></span>",n.sort((function(e,t){return e.validationErrors?-1:t.validationErrors?1:0})),s+="<span class='k-multiple-files-wrapper'>",a=0;a<n.length;a++){var l=H([i=n[a]]);s+="<span class='k-file-name-size-wrapper'>",i.validationErrors&&i.validationErrors.length>0?s+="<span class='k-file-name k-file-name-invalid' title='"+i.name+"'>"+i.name+"</span>":s+="<span class='k-file-name' title='"+i.name+"'>"+i.name+"</span>",s+="<span class='k-file-size'>"+l+"</span></span>"}return s+=o?"<span class='k-file-validation-message k-text-error'>"+this.localization.invalidFiles+"</span>":"<span class='k-file-information'>Total: "+n.length+" files, "+r+"</span>",e(s+="</span><strong class='k-upload-status'></strong>")},_enqueueFile:function(t,i){var n,o,r,s,l=this,p=i.fileNames[0].uid,d=e(".k-upload-files",l.wrapper),u=l.options.template;return 0===d.length&&(d=e("<ul class='k-upload-files k-reset'></ul>").appendTo(l.wrapper),l.options.showFileList||d.hide(),l.wrapper.removeClass("k-upload-empty")),n=e(".k-file",d),u?(r=l._prepareTemplateData(t,i),u=a.template(u),(o=e("<li class='k-file'>"+u(r)+"</li>")).find(".k-upload-action").addClass("k-button k-button-icon k-flat"),l.angular("compile",(function(){return{elements:o,data:[r]}}))):o=1===i.fileNames.length?l._prepareDefaultSingleFileEntryTemplate(i):l._prepareDefaultMultipleFileEntriesTemplate(i),o.attr(a.attr("uid"),p).appendTo(d).data(i),l._async||e(".k-progress",o).width("100%"),!l.multiple&&n.length>0&&(s={files:n.data("fileNames"),headers:{}},l.trigger(_,s)||l._module.onRemove({target:e(n,l.wrapper)},s)),o},_removeFileEntry:function(t){var a,i,n,o=this,r=t.closest(".k-upload-files");t.remove(),a=e(".k-file",r),i=e(".k-file-success, .k-file-error",r),n=e(".k-file-invalid",r),i.length!==a.length&&n.length!==a.length||this._hideActionButtons(),0===a.length?(r.remove(),o.wrapper.addClass("k-upload-empty"),o._hideHeaderUploadstatus()):o._updateHeaderUploadStatus()},_fileAction:function(e,t,a){var i,n={remove:"k-i-x",cancel:"k-i-cancel",retry:"k-i-retry",pause:"k-i-pause-sm"},o={remove:"k-i-close",cancel:"k-i-cancel",retry:"k-i-reload-sm",pause:"k-i-pause-sm"};n.hasOwnProperty(t)&&(a||this._clearFileAction(e),this.options.template?(i=e.find(".k-upload-action").first()).find(".k-icon").length?i.next(".k-upload-action").length&&i.next(".k-upload-action").addClass("k-button").append("<span class='k-icon "+o[t]+" "+n[t]+"' title='"+this.localization[t]+"'aria-label='"+this.localization[t]+"'></span>").show():i.addClass("k-button").append("<span class='k-icon "+o[t]+" "+n[t]+"' title='"+this.localization[t]+"'aria-label='"+this.localization[t]+"'></span>").show():(a||e.find(".k-upload-status .k-upload-action").remove(),e.find(".k-upload-status").append(this._renderAction(n[t],this.localization[t],o[t]))))},_fileState:function(t,a){var i=this.localization,n={uploading:{text:i.statusUploading},uploaded:{text:i.statusUploaded},failed:{text:i.statusFailed}}[a];n&&e("span.k-file-state",t).text(n.text)},_renderAction:function(t,a,i){return""!==t?e("<button type='button' class='k-button k-button-icon k-flat k-upload-action' aria-label='"+a+"'><span class='k-icon "+i+" "+t+"' title='"+a+"'></span></button>").on("focus",(function(){e(this).addClass("k-state-focused")})).on("blur",(function(){e(this).removeClass("k-state-focused")})):e("<button type='button' class='k-button'>"+a+"</button>")},_clearFileAction:function(t){e(".k-upload-action",t).empty().hide()},_onFileAction:function(t){var a=this;if(!a.wrapper.hasClass("k-state-disabled")){var i=e(t.target).closest(".k-upload-action"),n=i.find(".k-icon"),o=i.closest(".k-file"),r=o.data("fileNames"),s=a._filesContainValidationErrors(r),l={files:r,headers:{}};a._retryClicked=!1,n.hasClass("k-i-x")?a.trigger(_,l)||a._module.onRemove({target:e(o,a.wrapper)},l,!s):n.hasClass("k-i-cancel")?(a.trigger(h,l),a._module.onCancel({target:e(o,a.wrapper)}),a._checkAllComplete(),a._updateHeaderUploadStatus()):n.hasClass("k-i-pause-sm")?(a.trigger(k,l),a.pause(o),a._updateHeaderUploadStatus()):n.hasClass("k-i-play-sm")?(a.trigger(v,l),a.resume(o)):n.hasClass("k-i-retry")&&(e(".k-i-warning",o).remove(),e(".k-progressbar",o).finish().show(),a._module.onRetry({target:e(o,a.wrapper)}),a._retryClicked=!0)}return!1},_onUploadSelected:function(){return this.wrapper.hasClass("k-state-disabled")||this._module.onSaveSelected(),!1},_onClearSelected:function(){var e=this;return e.wrapper.hasClass("k-state-disabled")||e.trigger(m,{})||e.clearAllFiles(),!1},_onFileProgress:function(t,a){a>100&&(a=100),e(".k-progressbar",t.target).removeClass("k-hidden"),this.options.template||(0===e(".k-upload-pct",t.target).length&&e(".k-upload-status",t.target).prepend("<span class='k-upload-pct'></span>"),100!==a?e(".k-upload-pct",t.target).text(a+"%"):e(".k-upload-pct",t.target).remove()),e(".k-progress",t.target).width(a+"%"),this.trigger(g,{files:j(t).data("fileNames"),percentComplete:a})},_onUploadSuccess:function(e,t,a){var i=this,n=j(e),o=n.data("fileNames"),r=n.find(".k-file-information"),s=n.find(".k-file-size");i.trigger(u,{files:n.data("fileNames"),response:t,operation:"upload",XMLHttpRequest:a})?i._setUploadErrorState(n):(i._fileState(n,"uploaded"),n.removeClass("k-file-progress").addClass("k-file-success"),r.length>0?r.addClass("k-hidden").after('<span class="k-file-validation-message k-text-success">'+o.length+" "+i.localization.uploadSuccess+"</span>"):s.length>0&&s.addClass("k-hidden").after('<span class="k-file-validation-message k-text-success">'+i.localization.uploadSuccess+"</span>"),i._updateHeaderUploadStatus(),i._supportsRemove()?i._fileAction(n,_):i._clearFileAction(n)),i._hideUploadProgress(n),i._checkAllComplete()},_onUploadError:function(e,t){var a=this,i=a._module,n=j(e),r=n.data("uid");a._setUploadErrorState(n),a.trigger(c,{operation:"upload",files:n.data("fileNames"),XMLHttpRequest:t}),o("Server response: "+t.responseText),a.options.async.chunkSize?i._decreasePosition&&i._decreasePosition(r):a._hideUploadProgress(n),a._checkAllComplete(),this.options.async.autoRetryAfter&&this._autoRetryAfter(n)},_autoRetryAfter:function(e){var t=this,a=this._module.retries;a&&(a[e.data("uid")]||(a[e.data("uid")]=1),a[e.data("uid")]<=this.options.async.maxAutoRetries&&(a[e.data("uid")]++,setTimeout((function(){t._module.performUpload(e)}),this.options.async.autoRetryAfter)))},_setUploadErrorState:function(t){var a,i=this,n=t.data("fileNames"),o=t.find(".k-file-information"),r=t.find(".k-file-size");i._fileState(t,"failed"),t.removeClass("k-file-progress").addClass("k-file-error"),o.length>0?o.addClass("k-hidden").after('<span class="k-file-validation-message k-text-error">'+n.length+" "+i.localization.uploadFail+"</span>"):r.length>0&&r.addClass("k-hidden").after('<span class="k-file-validation-message k-text-error">'+i.localization.uploadFail+"</span>"),i._updateUploadProgress(t),(a=e(".k-upload-pct",t)).length>0&&a.remove(),this._updateHeaderUploadStatus(),this._fileAction(t,"retry"),this._fileAction(t,_,!0),i._retryClicked&&t.find(".k-i-retry").parent().focus()},_updateUploadProgress:function(t){var a=this;if(a.options.async.chunkSize){var i=t.data("uid");if(a._module.metaData){var n=a._module.metaData[i];if(n){var o=n.totalChunks?Math.round(n.chunkIndex/n.totalChunks*100):100;a._onFileProgress({target:e(t,a.wrapper)},o)}}}else e(".k-progress",t).width("100%")},_hideUploadProgress:function(t){e(".k-progressbar",t).delay(1e3).fadeOut(2e3,(function(){e(this).find(".k-progress").css("width","0%")}))},_showActionButtons:function(){var t=this,a=e(".k-action-buttons",t.wrapper),i=e(".k-upload-selected",t.wrapper),n=e(".k-clear-selected",t.wrapper);0===i.length&&(i=t._renderAction("",this.localization.uploadSelectedFiles).addClass("k-upload-selected").addClass("k-primary"),n=t._renderAction("",this.localization.clearSelectedFiles).addClass("k-clear-selected")),a.length||(a=e("<div />").addClass("k-action-buttons").append(n,i)),this.wrapper.append(a)},_hideActionButtons:function(){e(".k-action-buttons",this.wrapper).remove()},_showHeaderUploadStatus:function(t){var a=this,i=a.localization,n=e(".k-dropzone",a.wrapper),o=e(".k-upload-status-total",a.wrapper);0!==o.length&&o.remove(),e(".k-dropzone-hint",a.wrapper).addClass("k-hidden"),o='<strong class="k-upload-status k-upload-status-total"><span class="k-icon"></span></strong>',t?(o=e(o).append(i.headerStatusUploading)).find(".k-icon").addClass(C):(o=e(o).append(i.headerStatusUploaded)).find(".k-icon").addClass(z),n.length>0?n.append(o):e(".k-upload-button",a.wrapper).after(o)},_updateHeaderUploadStatus:function(){var t,a,i=this,n=e(".k-upload-status-total",this.wrapper),o=e(".k-file",i.wrapper).not(".k-file-success, .k-file-error, .k-file-invalid"),r=e(".k-file-invalid",i.wrapper),s=e(".k-file-error",i.wrapper),l=e(".k-file",i.wrapper).find(".k-i-play-sm");!l.length||l.length!==o.length&&i.options.async.concurrent?(0===o.length||r.length>0||s.length>0)&&(t=e(".k-file.k-file-error, .k-file.k-file-invalid",i.wrapper),n=e(".k-upload-status-total",i.wrapper),a=e(".k-icon",n).removeClass().addClass("k-icon").addClass(0!==t.length?z:S),n.html(a).append(i.localization.headerStatusUploaded)):(a=e(".k-icon",n).removeClass().addClass("k-icon").addClass("k-i-pause-sm"),n.html(a).append(i.localization.headerStatusPaused))},_hideHeaderUploadstatus:function(){var t=this.options.dropZone;e(".k-upload-status-total",this.wrapper).remove(),""===t&&e(".k-dropzone-hint",this.wrapper).removeClass("k-hidden")},_onParentFormSubmit:function(){var t=this.element;if(void 0!==this._module.onAbort&&this._module.onAbort(),!t.value){var a=e(t);a.attr("disabled","disabled"),window.setTimeout((function(){a.removeAttr("disabled")}),0)}},_onParentFormReset:function(){e(".k-upload-files",this.wrapper).remove()},_supportsFormData:function(){return"undefined"!=typeof FormData},_supportsMultiple:function(){var e=this._userAgent().indexOf("Windows")>-1;return!(a.support.browser.opera||a.support.browser.safari&&e)},_supportsDrop:function(){var e=this._userAgent().toLowerCase();return!(!/chrome/.test(e)&&/safari/.test(e)&&/windows/.test(e))&&this._supportsFormData()&&this.options.async.saveUrl},_userAgent:function(){return navigator.userAgent},_setupDropZone:function(){var t=this,a=t._ns,i=e(".k-dropzone",t.wrapper).on("dragenter"+a,Z).on("dragover"+a,(function(e){e.originalEvent&&(e.originalEvent.dataTransfer.dropEffect="copy"),e.preventDefault()})).on("drop"+a,e.proxy(t._onDrop,t));i.find(".k-dropzone-hint").length||i.append(e("<em class='k-dropzone-hint'>"+t.localization.dropFilesHere+"</em>")),V(i,a,(function(){i.closest(".k-upload").hasClass("k-state-disabled")||i.addClass("k-dropzone-hovered")}),(function(){i.removeClass("k-dropzone-hovered")})),t._bindDocumentDragEventWrappers(i)},_setupCustomDropZone:function(){var t=this,a=e(t.options.dropZone);t.wrapper.find(".k-dropzone-hint").length?e(".k-dropzone-hint",t.wrapper).addClass("k-hidden"):e(".k-dropzone",t.wrapper).append(e("<em class='k-dropzone-hint k-hidden'>"+t.localization.dropFilesHere+"</em>"));var i=t._ns;a.on("dragenter"+i,Z).on("dragover"+i,(function(e){e.originalEvent&&(e.originalEvent.dataTransfer.dropEffect="copy"),e.preventDefault()})).on("drop"+i,e.proxy(t._onDrop,t)),V(a,i,(function(i){t.wrapper.hasClass("k-state-disabled")||(a.removeClass("k-dropzone-hovered"),a.addClass("k-dropzone-hovered"),e(i.target).addClass("k-dropzone-hovered"))}),(function(){a.removeClass("k-dropzone-hovered"),a.find(".k-dropzone-hovered").removeClass("k-dropzone-hovered")})),t._bindDocumentDragEventWrappers(a)},_bindDocumentDragEventWrappers:function(t){var a=this,i=a._ns;V(e(document),i,(function(){a.wrapper.hasClass("k-state-disabled")||(t.addClass("k-dropzone-active"),t.closest(".k-upload").removeClass("k-upload-empty"),t.find(".k-dropzone-hint").removeClass("k-hidden"))}),(function(){t.removeClass("k-dropzone-active"),t.find(".k-dropzone-hint").addClass("k-hidden"),0===e("li.k-file",t.closest(".k-upload")).length&&t.closest(".k-upload").addClass("k-upload-empty")}))},_toggleDropZone:function(){var t=this,a=t.options.dropZone;t._supportsDrop()&&(e(a).off(t._ns),e(".k-dropzone",t.wrapper).off(t._ns),""!==a?t._setupCustomDropZone():t._setupDropZone())},_supportsRemove:function(){return!!this.options.async.removeUrl},_submitRemove:function(t,a,i,o){var s=this.options.async.removeField||"fileNames",l=e.extend(a.data,n());l[s]=t,r.ajax({type:this.options.async.removeVerb,dataType:"json",dataFilter:O,url:this.options.async.removeUrl,traditional:!0,data:l,headers:a.headers,success:i,error:o,xhrFields:{withCredentials:this.options.async.withCredentials}})},_wrapInput:function(e){var t=this.options;return e.wrap("<div class='k-widget k-upload'><div class='k-dropzone'><div class='k-button k-upload-button' aria-label='"+this.localization.select+"'></div></div></div>"),t.async.saveUrl?e.closest(".k-upload").addClass("k-upload-async"):e.closest(".k-upload").addClass("k-upload-sync"),e.closest(".k-upload").addClass("k-upload-empty"),e.closest(".k-button").append("<span>"+this.localization.select+"</span>"),e.closest(".k-upload")},_checkAllComplete:function(){0===e(".k-file.k-file-progress",this.wrapper).length&&this.trigger(f)},_inputFiles:function(e){return D(e)}}),b=function(e){this.name="syncUploadModule",this.element=e.wrapper,this.upload=e,this.element.closest("form").attr("enctype","multipart/form-data").attr("encoding","multipart/form-data")};b.prototype={onSelect:function(t,a){var i=this.upload,n=e(t.target),o=i._filesContainValidationErrors(a);i._addInput(n);var r={fileNames:a};o?n.remove():r.relatedInput=n;var s=i._enqueueFile(A(n),r);o&&i._hideUploadProgress(s),i._fileAction(s,_)},onRemove:function(e){var t=j(e),a=t.data("relatedInput");a&&a.remove(),this.upload._removeFileEntry(t)}};var x=function(e){this.name="iframeUploadModule",this.element=e.wrapper,this.upload=e,this.iframes=[]};U._frameId=0,x.prototype={onSelect:function(t,a){var i=this.upload,n=e(t.target),o=i._filesContainValidationErrors(a),r=this.prepareUpload(n,a,o);i.options.async.autoUpload?o?(i._fileAction(r,_),i._showHeaderUploadStatus(!1)):this.performUpload(r):(i._fileAction(r,_),o?i._updateHeaderUploadStatus():i._showActionButtons()),o&&i._hideUploadProgress(r)},prepareUpload:function(t,a,i){var n,o,r,s,l=this.upload,p=e(l.element),d=l.options.async.saveField||t.attr("name");return l._addInput(t),t.attr("name",d),i?(t.remove(),o={fileNames:a}):(r=this.createFrame(l.name+"_"+U._frameId++),this.registerFrame(r),s=this.createForm(l.options.async.saveUrl,r.attr("name")).append(p),o={frame:r,relatedInput:p,fileNames:a}),n=l._enqueueFile(A(t),o),r&&r.data({form:s,file:n}),n},performUpload:function(t){var a={files:t.data("fileNames")},i=t.data("frame"),o=this.upload,r=t.find(".k-file-validation-message"),s=t.find(".k-file-information"),l=t.find(".k-file-size");if(o.trigger(d,a))o._removeFileEntry(i.data("file")),this.cleanupFrame(i),this.unregisterFrame(i);else{o._hideActionButtons(),o._showHeaderUploadStatus(!0),i.appendTo(document.body);var p=i.data("form").attr("action",o.options.async.saveUrl).appendTo(document.body);for(var u in a.data=e.extend({},a.data,n()),a.data){var c=p.find("input[name='"+u+"']");0===c.length&&(c=e("<input>",{type:"hidden",name:u}).prependTo(p)),c.val(a.data[u])}o._fileAction(t,h),o._fileState(t,"uploading"),e(t).removeClass("k-file-error").addClass("k-file-progress"),r.length>0&&r.remove(),s.length>0?s.removeClass("k-hidden"):l.length>0&&l.removeClass("k-hidden"),i.one("load",e.proxy(this.onIframeLoad,this)),p[0].submit()}},onSaveSelected:function(){var t=this,a=t.upload;e(".k-file",this.element).each((function(){var i=e(this),n=X(i),o=a._filesContainValidationErrors(i.data("fileNames"));n||o||t.performUpload(i)}))},onIframeLoad:function(t){var a,i=e(t.target);try{a=i.contents().text()}catch(e){a="Error trying to get server response: "+e}this.processResponse(i,a)},processResponse:function(t,a){var i=t.data("file"),n=this,o={responseText:a};L(a,(function(a){e.extend(o,{statusText:"OK",status:"200"}),n.upload._onFileProgress({target:e(i,n.upload.wrapper)},100),n.upload._onUploadSuccess({target:e(i,n.upload.wrapper)},a,o),n.cleanupFrame(t),n.unregisterFrame(t)}),(function(){e.extend(o,{statusText:"error",status:"500"}),n.upload._onUploadError({target:e(i,n.upload.wrapper)},o)}))},onCancel:function(t){var a=e(t.target).data("frame");this.stopFrameSubmit(a),this.cleanupFrame(a),this.unregisterFrame(a),this.upload._removeFileEntry(a.data("file"))},onRetry:function(e){var t=j(e);this.performUpload(t)},onRemove:function(e,t,a){var i=this,n=i.upload,o=j(e),r=o.data("frame");r?(i.unregisterFrame(r),n._removeFileEntry(o),i.cleanupFrame(r)):o.hasClass("k-file-success")?M(o,n,t,a):n._removeFileEntry(o)},onAbort:function(){var t=this.element,a=this;e.each(this.iframes,(function(){e("input",this.data("form")).appendTo(t),a.stopFrameSubmit(this[0]),this.data("form").remove(),this.remove()})),this.iframes=[]},createFrame:function(t){return e("<iframe name='"+t+"' id='"+t+"' style='display:none;' />")},createForm:function(t,a){return e("<form enctype='multipart/form-data' method='POST' action='"+t+"' target='"+a+"'/>")},stopFrameSubmit:function(e){void 0!==e.stop?e.stop():e.document&&e.document.execCommand("Stop")},registerFrame:function(e){this.iframes.push(e)},unregisterFrame:function(t){this.iframes=e.grep(this.iframes,(function(e){return e.attr("name")!=t.attr("name")}))},cleanupFrame:function(e){var t=e.data("form");e.data("file").data("frame",null),setTimeout((function(){t.remove(),e.remove()}),1)}};var E=function(e){this.name="formDataUploadModule",this.element=e.wrapper,this.upload=e,this.position={},this.metaData={},this.cancelled={},this.resume={},this.paused={},this.retries={}};function A(t){return e.map(D(t),(function(e){return e.name})).join(", ")}function D(e){var t,a,i=e[0];return i.files?R(i.files):[{name:(t=i.value,a=t.lastIndexOf("\\"),-1!=a?t.substr(a+1):t),extension:I(i.value),size:null}]}function R(t){return e.map(t,(function(e){return i=(t=e).name||t.fileName,{name:a.htmlEncode(i),extension:I(i),size:"number"==typeof t.size?t.size:t.fileSize,rawFile:t};var t,i}))}function I(e){var t=e.match(s);return t?t[0]:""}function P(t,i){var n=a.guid();return e.map(t,(function(e){return e.uid=i?a.guid():n,e}))}function T(t,a){for(var i=(s=a.allowedExtensions,e.map(s,(function(e){return("."===e.substring(0,1)?e:"."+e).toLowerCase()}))),n=a.maxFileSize,o=a.minFileSize,r=0;r<t.length;r++)N(t[r],i),B(t[r],o,n);var s}function N(t,a){a.length>0&&a.indexOf(t.extension.toLowerCase())<0&&(t.validationErrors=t.validationErrors||[],-1===e.inArray(w,t.validationErrors)&&t.validationErrors.push(w))}function B(t,a,i){0!==a&&t.size<a&&(t.validationErrors=t.validationErrors||[],-1===e.inArray(F,t.validationErrors)&&t.validationErrors.push(F)),0!==i&&t.size>i&&(t.validationErrors=t.validationErrors||[],-1===e.inArray(y,t.validationErrors)&&t.validationErrors.push(y))}function H(e){var t=0;if("number"!=typeof e[0].size)return"";for(var a=0;a<e.length;a++)e[a].size&&(t+=e[a].size);return(t/=1024)<1024?t.toFixed(2)+" KB":(t/1024).toFixed(2)+" MB"}function q(t){return!t.multiple&&e(".k-file",t.wrapper).length>1}function M(t,a,i,n){if(a._supportsRemove()){var r=t.data("fileNames"),s=e.map(r,(function(e){return e.name}));!1!==n?a._submitRemove(s,i,(function(e,i,n){a.trigger(u,{operation:"remove",files:r,response:e,XMLHttpRequest:n})||a._removeFileEntry(t)}),(function(e){q(a)&&a._removeFileEntry(t),a.trigger(c,{operation:"remove",files:r,XMLHttpRequest:e}),o("Server response: "+e.responseText)})):a._removeFileEntry(t)}else!q(a)&&n||a._removeFileEntry(t)}function L(t,a,i){var n=!1,o="";try{o=e.parseJSON(O(t)),n=!0}catch(e){i()}n&&a(o)}function O(e){return void 0!==e&&""!==e||(e="{}"),e}function Z(e){e.originalEvent&&(e.originalEvent.dataTransfer.dropEffect="copy"),e.stopPropagation(),e.preventDefault()}function V(e,t,a,i){var n,o;e.on("dragenter"+t,(function(e){a(e),o=new Date,n||(n=setInterval((function(){new Date-o>100&&(i(),clearInterval(n),n=null)}),100))})).on("dragover"+t,(function(){o=new Date}))}function X(e){return e.is(".k-file-progress, .k-file-success, .k-file-error")}function j(t){return e(t.target).closest(".k-file")}E.prototype={onSelect:function(t,a){var i,n,o=this.upload,r=this,s=e(t.target),l=this.prepareUpload(s,a);e.each(l,(function(t){i=o._filesContainValidationErrors(e(this.data("fileNames"))),o.options.async.autoUpload?i?(o._fileAction(this,_),o._showHeaderUploadStatus(!1)):o.options.async.chunkSize?(r.prepareChunk(this),n=this.prev(),(o.options.async.concurrent||0===t&&!n.length||0===t&&n.hasClass("k-file-success"))&&r.performUpload(this)):r.performUpload(this):(o._fileAction(this,_),i?o._updateHeaderUploadStatus():(o._showActionButtons(),this.addClass("k-toupload"))),i&&o._hideUploadProgress(this)}))},prepareUpload:function(t,a){var i=this.enqueueFiles(a);return t.is("input")&&(e.each(i,(function(){e(this).data("relatedInput",t)})),t.data("relatedFileEntries",i),this.upload._addInput(t)),i},enqueueFiles:function(t){var a,i,n,o,r=this.upload,s=t.length,l=[];if(!0===r.options.async.batch)a=e.map(t,(function(e){return e.name})).join(", "),(r.directory||r.options.directoryDrop)&&e(t).each((function(){(this.rawFile.webkitRelativePath||this.rawFile.relativePath)&&(this.name=this.rawFile.webkitRelativePath||this.rawFile.relativePath)})),(o=r._enqueueFile(a,{fileNames:t})).data("files",t),l.push(o);else for(i=0;i<s;i++)a=(n=t[i]).name,(r.directory||r.options.directoryDrop)&&(n.rawFile.webkitRelativePath||n.rawFile.relativePath)&&(n.name=n.rawFile.webkitRelativePath||n.rawFile.relativePath),(o=r._enqueueFile(a,{fileNames:[n]})).data("files",[n]),l.push(o);return l},performUpload:function(t){var a,i=this.upload,o=this.createFormData(),r=this.createXHR(),s={files:t.data("fileNames"),XMLHttpRequest:r},l=t.find(".k-file-validation-message"),p=t.find(".k-file-information"),u=t.find(".k-file-size");if(i.trigger(d,s))this.removeFileEntry(t);else{if(0===t.find(".k-i-cancel").length&&(i.options.async.chunkSize&&i._fileAction(t,k),i._fileAction(t,h,i.options.async.chunkSize)),i.wrapper.find(".k-toupload").length||i._hideActionButtons(),i._showHeaderUploadStatus(!0),s.formData)o=s.formData;else{for(var c in s.data=e.extend({},s.data,n()),s.data)o.append(c,s.data[c]);(a=t.data("files"))&&this.populateFormData(o,a)}i._fileState(t,"uploading"),e(t).removeClass("k-file-error").addClass("k-file-progress"),l.length>0&&l.remove(),p.length>0?p.removeClass("k-hidden"):u.length>0&&u.removeClass("k-hidden"),i.options.async.useArrayBuffer&&window.FileReader?this._readFile(i.options.async.saveUrl,o,t,r):this.postFormData(i.options.async.saveUrl,o,t,r)}},_readFile:function(t,a,i,n){var o=this,r=o.upload,s=i.data("files")[0],l=new FileReader;l.onload=function(l){try{o.fileArrayBuffer?o.fileArrayBuffer=o._appendBuffer(o.fileArrayBuffer,l.target.result):o.fileArrayBuffer=l.target.result}catch(t){return void r._onUploadError({target:e(i,r.wrapper)},n)}o.position[s.uid]>s.size?(o.postFormData(r.options.async.saveUrl,o.fileArrayBuffer,i,n),o.fileArrayBuffer=null):o._readFile(t,a,i,n)},l.onerror=function(){r._onUploadError({target:e(i,r.wrapper)},n)},l.readAsArrayBuffer(o._getCurrentChunk(s.rawFile,s.uid))},_appendBuffer:function(e,t){var a=new Uint8Array(e.byteLength+t.byteLength);return a.set(new Uint8Array(e),0),a.set(new Uint8Array(t),e.byteLength),a.buffer},onSaveSelected:function(){var t=this,a=t.upload;e(".k-toupload",this.element).filter((function(){var t=e(this),i=X(t),n=a._filesContainValidationErrors(t.data("fileNames"));return!i&&!n})).each((function(i){var n=e(this),o=n.prev();n.removeClass("k-toupload"),a.options.async.chunkSize?(t.prepareChunk(n),(a.options.async.concurrent||0===i&&!o.length||0===i&&o.hasClass("k-file-success")||o.hasClass("k-file-error"))&&t.performUpload(n)):t.performUpload(n)}))},onCancel:function(e){var t=j(e);this.upload.options.async.chunkSize&&(this.cancelled[t.data("uid")]=!0),this.stopUploadRequest(t),this.removeFileEntry(t)},onPause:function(e){var t=j(e).data("uid"),a=this.upload.options.async;a.chunkSize&&(this.retries[t]=a.maxAutoRetries+1,this.paused[t]=!0,this.resume[t]=!1)},onResume:function(e){var t=j(e),a=t.data("uid");this.upload.options.async.chunkSize&&(delete this.paused[a],this.resume[a]=!0,this.retries[t.data("uid")]=1,this._increaseChunkIndex(a),this.performUpload(t))},onRetry:function(e){var t=j(e),a=this.upload.options.async;a.chunkSize&&(this.retries[t.data("uid")]=a.maxAutoRetries+1,delete this.paused[t.data("uid")]),this.performUpload(t)},onRemove:function(e,t,a){var i=this.upload,n=j(e),o=this.upload.options.async;o.chunkSize&&(this.retries[n.data("uid")]=o.maxAutoRetries+1),n.hasClass("k-file-success")?M(n,i,t,a):this.removeFileEntry(n)},createXHR:function(){return new XMLHttpRequest},postFormData:function(e,t,a,i){var n=this;a.data("request",i),i.addEventListener("load",(function(e){n.onRequestSuccess.call(n,e,a)}),!1),i.addEventListener(c,(function(e){n.onRequestError.call(n,e,a)}),!1),i.upload.addEventListener("progress",(function(e){n.onRequestProgress.call(n,e,a)}),!1),i.open("POST",e,!0),i.withCredentials=this.upload.options.async.withCredentials;var o=this.upload.options.async.accept;o&&i.setRequestHeader("Accept",o),i.send(t)},createFormData:function(){return new FormData},populateFormData:function(e,t){var a,i,n,o=t.length,r=this.upload;if(r.options.async.chunkSize){n=t[0].uid,a=this._getCurrentChunk(t[0].rawFile,n),e.append(r.options.async.saveField||r.name,a);var s=JSON.stringify(this.metaData[n]);e.append("metadata",s)}else for(i=0;i<o;i++)e.append(r.options.async.saveField||r.name,t[i].rawFile);return e},onRequestSuccess:function(t,a){var i=t.target,n=this;function o(){n.upload._onUploadError({target:e(a,n.upload.wrapper)},i)}i.status>=200&&i.status<=299?L(i.responseText,(function(t){var o=n.upload.options.async.batch,r=n.upload.options.async.chunkSize,s=n.upload.options.async.concurrent,l=t.fileUid;n.paused[l]||n.cancelled[l]||(delete n.retries[l],!r||o||t.uploaded?!r||o||s||!a.next().length||a.next().hasClass("k-toupload")?(n.upload._onFileProgress({target:e(a,n.upload.wrapper)},100),n.upload._onUploadSuccess({target:e(a,n.upload.wrapper)},t,i),n.cleanupFileEntry(a)):(n.upload._onFileProgress({target:e(a,n.upload.wrapper)},100),n._resetChunkIndex(l),n.upload._onUploadSuccess({target:e(a,n.upload.wrapper)},t,i),n.performUpload(a.next())):(n._increaseChunkIndex(l),n.performUpload(a)))}),o):o()},onRequestError:function(t,a){var i=t.target;this.upload._onUploadError({target:e(a,this.upload.wrapper)},i)},cleanupFileEntry:function(t){var a=t.data("relatedInput"),i=!0;a&&(e.each(a.data("relatedFileEntries")||[],(function(){this.parent().length>0&&this[0]!=t[0]&&(i=i&&this.hasClass("k-file-success"))})),i&&a.remove())},removeFileEntry:function(e){var t=this.upload.options.async.chunkSize,a=this.upload.options.async.concurrent,i=this.upload.wrapper.find(".k-upload-selected").length>0;this.cleanupFileEntry(e),!t||a||i||e.next().length&&this.performUpload(e.next()),this.upload._removeFileEntry(e)},onRequestProgress:function(t,a){var i,n=Math.round(100*t.loaded/t.total),o=a.data("uid");this.upload.options.async.chunkSize&&(n=(i=this.metaData[o])&&i.totalChunks?Math.round(i.chunkIndex/i.totalChunks*100):100),this.upload._onFileProgress({target:e(a,this.upload.wrapper)},n)},stopUploadRequest:function(e){e.data("request").abort()},prepareChunk:function(e){var t=e.data("files")[0],a=t.rawFile,i=t.uid,n=this.upload.options.async.chunkSize;this.position[i]=0,this.metaData[i]={chunkIndex:0,contentType:a.type,fileName:a.name,relativePath:t.name,totalFileSize:a.size,totalChunks:Math.ceil(a.size/n),uploadUid:i}},_decreaseChunkIndex:function(e){this.metaData[e].chunkIndex--},_increaseChunkIndex:function(e){this.metaData[e].chunkIndex++},_resetChunkIndex:function(e){this.metaData[e].chunkIndex=0},_decreasePosition:function(e){this.position[e]-=this.upload.options.async.chunkSize},_getCurrentChunk:function(e,t){var a,i=this.position[t],n=this.upload.options.async,o=n.chunkSize||n.bufferChunkSize;return this.position[t]||(this.position[t]=0),this.position[t]+=o,(a=this._getChunker(e))?e[a](i,this.position[t]):e},_getChunker:function(e){return e.slice?"slice":e.mozSlice?"mozSlice":e.webkitSlice?"webkitSlice":null}},a.ui.plugin(U)}(window.kendo.jQuery),window.kendo})?i.apply(t,n):i)||(e.exports=o)}).call(t,a(1048))}})}}]);