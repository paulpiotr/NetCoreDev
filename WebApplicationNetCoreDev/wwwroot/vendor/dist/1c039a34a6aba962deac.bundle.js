(self.webpackChunk_5_112_1332=self.webpackChunk_5_112_1332||[]).push([[1827],{2157:(e,t,n)=>{e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={exports:{},id:i,loaded:!1};return e[i].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}return n.m=e,n.c=t,n.p="",n(0)}({0:function(e,t,n){n(1610),e.exports=n(1610)},3:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},5:function(e,t){e.exports=n(6758)},20:function(e,t){e.exports=n(1657)},1610:function(e,t,n){var i,a,s;n(3),a=[n(20),n(5)],void 0===(s="function"==typeof(i=function(){!function(e){var t=e.spreadsheet.Filter=e.Class.extend({prepare:function(){},value:function(e){return e.value},matches:function(){throw new Error("The 'matches' method is not implemented.")},toJSON:function(){throw new Error("The 'toJSON' method is not implemented.")}});function n(e){var t=e.getMonth()+1;return t>=1&&t<=3?1:t>=4&&t<=6?2:t>=7&&t<=9?3:4}function i(t,n){if(t instanceof Date){var i=e.date.today();return i.setFullYear(i.getFullYear()+n),i.getFullYear()===t.getFullYear()}return!1}function a(t,n){if(t instanceof Date){var i=e.date.firstDayOfMonth(e.date.today());return i.setMonth(i.getMonth()+n,1),i.getTime()===e.date.firstDayOfMonth(t).getTime()}return!1}function s(t,n){if(n instanceof Date){var i=e.date.dayOfWeek(e.date.getDate(t),1),a=e.date.dayOfWeek(e.date.getDate(n),1);return i.getTime()===a.getTime()}return!1}t.create=function(t){var n=t.filter;if(!n)throw new Error("Filter type not specified.");var i=e.spreadsheet[n.charAt(0).toUpperCase()+n.substring(1)+"Filter"];if(!i)throw new Error("Filter type not recognized.");return new i(t)},e.spreadsheet.ValueFilter=t.extend({_values:[],_dates:[],_blanks:!1,init:function(e){void 0!==e.values&&(this._values=e.values),void 0!==e.blanks&&(this._blanks=e.blanks),void 0!==e.dates&&(this._dates=e.dates)},value:function(t){var n=t.value;return this._dates.length>0&&t.format&&"number"==typeof n&&"date"===e.spreadsheet.formatting.type(n,t.format)&&(n=e.spreadsheet.numberToDate(n)),n},matches:function(e){return null==e?this._blanks:e instanceof Date?this._dates.some((function(t){return!(t.year!==e.getFullYear()||void 0!==t.month&&t.month!==e.getMonth()||void 0!==t.day&&t.day!==e.getDate()||void 0!==t.hours&&t.hours!==e.getHours()||void 0!==t.minutes&&t.minutes!==e.getMinutes()||void 0!==t.seconds&&t.seconds!==e.getSeconds())})):this._values.indexOf(e)>=0},toJSON:function(){return{filter:"value",blanks:this._blanks,values:this._values.slice(0)}}}),e.spreadsheet.CustomFilter=t.extend({_logic:"and",init:function(t){if(void 0!==t.logic&&(this._logic=t.logic),void 0===t.criteria)throw new Error("Must specify criteria.");this._criteria=t.criteria;var n=e.data.Query.filterExpr({logic:this._logic,filters:this._criteria,accentFoldingFiltering:e.culture().name}).expression;this._matches=new Function("d","return "+n)},matches:function(e){return null!==e&&this._matches(e)},value:function(t){var n=t.value,i=this._criteria[0].value,a=i instanceof Date?"date":typeof i,s=typeof n;return t.format&&(s=e.spreadsheet.formatting.type(n,t.format)),s!=a?"string"==a&&(t.format&&(n=e.spreadsheet.formatting.text(n,t.format)),n+=""):"date"==s&&(n=e.spreadsheet.numberToDate(n)),n},toJSON:function(){return{filter:"custom",logic:this._logic,criteria:this._criteria}}}),e.spreadsheet.TopFilter=t.extend({init:function(e){this._type=e.type,this._value=e.value,this._values=[]},prepare:function(e){var t=e.map(this.value).sort().filter((function(e,t,n){return 0===t||e!==n[t-1]}));"topNumber"===this._type||"topPercent"==this._type?t.sort((function(e,t){return t-e})):t.sort((function(e,t){return e-t}));var n=this._value;"topPercent"!==this._type&&"bottomPercent"!==this._type||(n=t.length*n/100>>0),this._values=t.slice(0,n)},matches:function(e){return this._values.indexOf(e)>=0},toJSON:function(){return{filter:"top",type:this._type,value:this._value}}}),e.spreadsheet.DynamicFilter=t.extend({init:function(e){if(this._type=e.type,this._predicate=this[e.type],"function"!=typeof this._predicate)throw new Error("DynamicFilter type '"+e.type+"' not recognized.")},value:function(t){var n=t.value;return t.format&&"date"===e.spreadsheet.formatting.type(n,t.format)&&(n=e.spreadsheet.numberToDate(n)),n},prepare:function(e){for(var t=0,n=0,i=0;i<e.length;i++){var a=this.value(e[i]);"number"==typeof a&&(t+=a,n++)}this._average=n>0?t/n:0},matches:function(e){return this._predicate(e)},aboveAverage:function(t){return t instanceof Date&&(t=e.spreadsheet.dateToNumber(t)),"number"==typeof t&&t>this._average},belowAverage:function(t){return t instanceof Date&&(t=e.spreadsheet.dateToNumber(t)),"number"==typeof t&&t<this._average},tomorrow:function(t){if(t instanceof Date){var n=e.date.addDays(e.date.today(),1);return e.date.getDate(t).getTime()===n.getTime()}return!1},today:function(t){return t instanceof Date&&e.date.isToday(t)},yesterday:function(t){if(t instanceof Date){var n=e.date.addDays(e.date.today(),-1);return e.date.getDate(t).getTime()===n.getTime()}return!1},nextWeek:function(t){return s(e.date.addDays(e.date.today(),7),t)},thisWeek:function(t){return s(e.date.today(),t)},lastWeek:function(t){return s(e.date.addDays(e.date.today(),-7),t)},nextMonth:function(e){return a(e,1)},thisMonth:function(e){return a(e,0)},lastMonth:function(e){return a(e,-1)},nextQuarter:function(t){if(t instanceof Date){var i=e.date.today(),a=n(t)-n(i);return 1===a&&i.getFullYear()===t.getFullYear()||-3==a&&i.getFullYear()+1===t.getFullYear()}return!1},thisQuarter:function(t){if(t instanceof Date){var i=e.date.today();return 0==n(t)-n(i)&&i.getFullYear()===t.getFullYear()}return!1},lastQuarter:function(t){if(t instanceof Date){var i=e.date.today(),a=n(i)-n(t);return 1===a&&i.getFullYear()===t.getFullYear()||-3==a&&i.getFullYear()-1===t.getFullYear()}return!1},nextYear:function(e){return i(e,1)},thisYear:function(e){return i(e,0)},lastYear:function(e){return i(e,-1)},yearToDate:function(t){if(t instanceof Date){var n=e.date.today();return t.getFullYear()===n.getFullYear()&&t<=n}return!1},toJSON:function(){return{filter:"dynamic",type:this._type}}}),[1,2,3,4].forEach((function(t){e.spreadsheet.DynamicFilter.prototype["quarter"+t]=function(e){return e instanceof Date&&n(e)===t}})),e.cultures["en-US"].calendar.months.names.forEach((function(t,n){e.spreadsheet.DynamicFilter.prototype[t.toLowerCase()]=function(e){return e instanceof Date&&e.getMonth()===n}}))}(kendo)})?i.apply(t,a):i)||(e.exports=s)}})},38:(e,t,n)=>{e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={exports:{},id:i,loaded:!1};return e[i].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}return n.m=e,n.c=t,n.p="",n(0)}({0:function(e,t,n){n(1611),e.exports=n(1611)},3:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},20:function(e,t){e.exports=n(1657)},953:function(e,t){e.exports=n(3261)},956:function(e,t){e.exports=n(1996)},1579:function(e,t){e.exports=n(5379)},1611:function(e,t,n){var i,a,s;n(3),a=[n(20),n(953),n(956),n(1579),n(1612),n(1613)],void 0===(s="function"==typeof(i=function(){!function(e){var t=e.jQuery,n=e.ui.Widget,i={details:"k-details",button:"k-button",detailsSummary:"k-details-summary",detailsContent:"k-details-content",icon:"k-icon",iconCollapse:"k-i-arrow-45-down-right",iconExpand:"k-i-arrow-60-right",iconSearch:"k-i-zoom",textbox:"k-textbox",wrapper:"k-spreadsheet-filter-menu",filterByCondition:"k-spreadsheet-condition-filter",filterByValue:"k-spreadsheet-value-filter",valuesTreeViewWrapper:"k-spreadsheet-value-treeview-wrapper",actionButtons:"k-action-buttons"};e.spreadsheet.messages.filterMenu={all:"All",sortAscending:"Sort range A to Z",sortDescending:"Sort range Z to A",filterByValue:"Filter by value",filterByCondition:"Filter by condition",apply:"Apply",search:"Search",addToCurrent:"Add to current selection",clear:"Clear",blanks:"(Blanks)",operatorNone:"None",and:"AND",or:"OR",operators:{string:{contains:"Text contains",doesnotcontain:"Text does not contain",startswith:"Text starts with",endswith:"Text ends with",matches:"Text matches",doesnotmatch:"Text does not match"},date:{eq:"Date is",neq:"Date is not",lt:"Date is before",gt:"Date is after"},number:{eq:"Is equal to",neq:"Is not equal to",gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"}}};var a=n.extend({init:function(i,a){n.fn.init.call(this,i,a),this.element.addClass(h.classNames.details),this._summary=this.element.find("."+h.classNames.detailsSummary).on("click",this._toggle.bind(this));var s=a.expanded?h.classNames.iconCollapse:h.classNames.iconExpand;this._icon=t("<span />",{class:h.classNames.icon+" "+s}).prependTo(this._summary),this._container=e.wrap(this._summary.next(),!0),a.expanded||this._container.hide()},options:{name:"Details"},events:["toggle"],visible:function(){return this.options.expanded},toggle:function(t){e.fx(this._container).expand("vertical").stop()[t?"reverse":"play"](),this._icon.toggleClass(h.classNames.iconExpand,t).toggleClass(h.classNames.iconCollapse,!t),this.options.expanded=!t},_toggle:function(){var e=this.visible();this.toggle(e),this.trigger("toggle",{show:e})}});e.data.binders.spreadsheetFilterValue=e.data.Binder.extend({init:function(n,i,a){e.data.Binder.fn.init.call(this,n,i,a),this._change=t.proxy(this.change,this),t(this.element).on("change",this._change)},refresh:function(){var e=this.bindings.spreadsheetFilterValue.get();t(this.element).val(e instanceof Date?"":e)},change:function(){var e=this.element.value;this.bindings.spreadsheetFilterValue.set(e)}}),e.data.binders.widget.spreadsheetFilterValue=e.data.Binder.extend({init:function(n,i,a){e.data.Binder.fn.init.call(this,n.element[0],i,a),this.widget=n,this._change=t.proxy(this.change,this),this.widget.first("change",this._change)},refresh:function(){var e=this.bindings.spreadsheetFilterValue.get(),n=t(this.widget.element).data("filterType");"date"===n&&e instanceof Date||"number"===n&&!isNaN(e)?this.widget.value(e):this.widget.value(null)},change:function(){var e=this.widget.value();this.bindings.spreadsheetFilterValue.set(e)}});var s={filterByValue:"<div class='"+i.detailsSummary+"'>#= messages.filterByValue #</div><div class='"+i.detailsContent+"'><div class='k-textbox k-space-right'><input placeholder='#= messages.search #' data-#=ns#bind='events: { input: filterValues }' /><span class='k-icon k-i-zoom'></span></div><div data-#=ns#bind='visible: hasActiveSearch'><input class='k-checkbox' type='checkbox' data-#=ns#bind='checked: appendToSearch' id='_#=guid#'/><label class='k-checkbox-label' for='_#=guid#'>#= messages.addToCurrent #</label></div><div class='"+i.valuesTreeViewWrapper+"'><div data-#=ns#role='treeview' data-#=ns#checkboxes='{ checkChildren: true }' data-#=ns#bind='source: valuesDataSource, events: { check: valuesChange, select: valueSelect }' ></div></div></div>",filterByCondition:"<div class='"+i.detailsSummary+"'>#= messages.filterByCondition #</div><div class='"+i.detailsContent+'\'><div><select data-#=ns#role="dropdownlist"data-#=ns#bind="value: operator, source: operators, events: { change: operatorChange } "data-value-primitive="false"data-option-label="#=messages.operatorNone#"data-height="auto"data-text-field="text"data-value-field="unique"></select></div><div data-#=ns#bind="visible: isString"><input data-filter-type="string" data-#=ns#bind="spreadsheetFilterValue: customFilter.criteria[0].value" class="k-textbox" /></div><div data-#=ns#bind="visible: isNumber"><input data-filter-type="number" data-#=ns#role="numerictextbox" data-#=ns#bind="spreadsheetFilterValue: customFilter.criteria[0].value" /></div><div data-#=ns#bind="visible: isDate"><input data-filter-type="date" data-#=ns#role="datepicker" data-#=ns#bind="spreadsheetFilterValue: customFilter.criteria[0].value" /></div></div>',menuItem:"<li data-command='#=command#' data-dir='#=dir#'><span class='k-icon k-i-#=iconClass#'></span>#=text#</li>",actionButtons:"<button data-#=ns#bind='click: apply' class='k-button k-primary'>#=messages.apply#</button><button data-#=ns#bind='click: clear' class='k-button'>#=messages.clear#</button>"};function r(t,n){for(var i=!1,a=t instanceof e.data.HierarchicalDataSource&&t.data(),s=this.values,o=0;o<a.length;o++){var l=a[o],u=l.text.toString().toLocaleLowerCase(e.culture().name),c=!0===n||""===n||u.indexOf(n)>=0,h=r.bind(this)(l.children,n);i=i||h||c,l.hidden=!c&&!h,n.length||s&&!s.length?l.checked=!l.hidden:s&&-1!=s.indexOf(l.text)&&(l.checked=!0)}return a&&t.filter({field:"hidden",operator:"neq",value:!0}),i}function o(t){for(var n=t instanceof e.data.HierarchicalDataSource&&t.data(),i=0;i<n.length;i++){var a=n[i];a.checked=!1,a.hasChildren&&o(a.children)}}var l=e.spreadsheet.FilterMenuViewModel=e.data.ObservableObject.extend({valuesChange:function(t){var n=(t?t.sender.dataSource:this.valuesDataSource).data().toJSON()[0].items,i=n.filter((function(e){return"blank"===e.dataType}));i=!!i.length&&i[0].checked,n=n.filter((function(e){return e.checked})).map((function(t){return"date"===t.dataType?e.spreadsheet.dateToNumber(t.value):t.value})),this.appendToSearch&&this.valueFilter&&this.valueFilter.values.length&&(n=n.concat(this.valueFilter.values.toJSON()).sort().filter((function(e,t,n){return n.lastIndexOf(e)===t}))),this.set("valueFilter",{values:n,blanks:i})},valueSelect:function(e){e.preventDefault();var t=e.sender.dataItem(e.node);t.set("checked",!t.checked)},hasActiveSearch:!1,appendToSearch:!1,filterValues:function(n){var i="string"==typeof n?n:t(n.target).val().toLocaleLowerCase(e.culture().name),a=this.valuesDataSource;this.set("hasActiveSearch",!!i);var s=r.bind(this.valueFilter);o(a),s(a,i)},reset:function(){this.set("customFilter",{logic:"and",criteria:[{operator:null,value:null}]}),this.set("valueFilter",{values:[]})},operatorChange:function(e){var t=e.sender.dataItem();this.set("operatorType",t.type),this.get("customFilter")||this.reset(),this.set("customFilter.criteria[0].operator",t.value)},isNone:function(){return void 0===this.get("operatorType")},isString:function(){return"string"===this.get("operatorType")},isNumber:function(){return"number"===this.get("operatorType")},isDate:function(){return"date"===this.get("operatorType")}});function u(t){var n=e.spreadsheet.messages.filterMenu.operators,i=[];for(var a in t)if(t.hasOwnProperty(a))for(var s in t[a])t[a].hasOwnProperty(s)&&i.push({text:n[a][s],value:s,unique:a+"_"+s,type:a});return i}var c=e.spreadsheet.FilterMenuController={valuesTree:function(t,n){return[{text:e.spreadsheet.messages.filterMenu.all,expanded:!0,checked:!1,items:this.values(t.resize({top:1}),n)}]},values:function(t,n){var i=[],a=e.spreadsheet.messages.filterMenu,s=t.column(n),r=t.sheet();return s.forEachCell((function(t,n,s){var o=!0;r.isHiddenRow(t)&&(o=!1);var l=s.value,u=s.dataType,c=s.text;u=void 0===l?"blank":s.format?e.spreadsheet.formatting.type(l,s.format):typeof l,c=null!==l&&s.format?e.spreadsheet.formatting.text(l,s.format):"blank"==u?a.blanks:l,"percent"!==u&&"currency"!==u||(u="number"),"date"===u&&(l=e.spreadsheet.numberToDate(l)),i.push({dataType:u,value:l,text:c,checked:o})})),(i=function(e){for(var t={},n=[],i=0;i<e.length;i++)t[e[i].value]?!t[e[i].value].checked&&e[i].checked&&(t[e[i].value].checked=!0):(t[e[i].value]=e[i],n.push(e[i]));return n}(i)).sort((function(e,t){return e.dataType===t.dataType?0:"blank"===e.dataType||"blank"===t.dataType?"blank"===e.dataType?-1:1:"number"===e.dataType||"number"===t.dataType?"number"===e.dataType?-1:1:"date"===e.dataType||"date"===t.dataType?"date"===e.dataType?-1:1:0})),i},filterType:function(e,t){var n,i=e.sheet(),a=this.filterForColumn(t,i);if((a=a&&a.filter.toJSON())&&"custom"==a.filter){var s=a.criteria[0].value;s instanceof Date?n="date":"string"==typeof s?n="string":"number"==typeof s&&(n="number")}if(!n){var r=this.values(e.row(1),t)[0];"blank"==(n=r&&r.dataType)&&(n=null)}return n},filterForColumn:function(e,t){var n,i=t.filter();return i&&(n=i.columns.filter((function(t){return t.index===e}))[0]),n},filter:function(e,t){var n=this.filterForColumn(e,t);if(n){var i=n.filter.toJSON(),a=i.filter;delete i.filter;var s={type:a,options:i},r=i.criteria;return r&&r.length&&(s.operator=r[0].operator),s}}},h=n.extend({init:function(e,t){n.call(this,e,t),this.element.addClass(h.classNames.wrapper),this.viewModel=new l({active:"value",operator:null,operators:u(this.options.operators),clear:this.clear.bind(this),apply:this.apply.bind(this)}),this._filterInit(),this._popup(),this._sort(),this._filterByCondition(),this._filterByValue(),this._actionButtons()},options:{name:"FilterMenu",column:0,range:null,operators:{string:{contains:"Text contains",doesnotcontain:"Text does not contain",startswith:"Text starts with",endswith:"Text ends with",matches:"Text matches",doesnotmatch:"Text does not match"},date:{eq:"Date is",neq:"Date is not",lt:"Date is before",gt:"Date is after"},number:{eq:"Is equal to",neq:"Is not equal to",gte:"Is greater than or equal to",gt:"Is greater than",lte:"Is less than or equal to",lt:"Is less than"}}},events:["action"],destroy:function(){n.fn.destroy.call(this),this.menu.destroy(),this.valuesTreeView.destroy(),this.popup.destroy()},openFor:function(e){this.popup.setOptions({anchor:e}),this.popup.open()},close:function(){this.popup.close()},clear:function(){this.action({command:"ClearFilterCommand",options:{column:this.options.column}}),this.viewModel.reset(),this.close()},apply:function(){this._active();var e,t,n={operatingRange:this.options.range,column:this.options.column};"value"===this.viewModel.active?(this.viewModel.valuesChange({sender:this.valuesTreeView}),((e=this.viewModel.valueFilter.toJSON()).blanks||e.values&&e.values.length)&&(n.valueFilter=e)):"custom"===this.viewModel.active&&(t=this.viewModel.customFilter.toJSON()).criteria.length&&null!==t.criteria[0].value&&(n.customFilter=t),(n.valueFilter||n.customFilter)&&this.action({command:"ApplyFilterCommand",options:n})},action:function(e){this.trigger("action",t.extend({},e))},_filterInit:function(){var e=this.options.column,t=this.options.range,n=t.sheet(),i=c.filter(e,n);if(i){var a=c.filterType(t,e);this.viewModel.set("active",i.type),this.viewModel.set(i.type+"Filter",i.options),"custom"==i.type&&(this.viewModel.set("operator",a+"_"+i.operator),this.viewModel.set("operatorType",a))}else this.viewModel.reset()},_popup:function(){this.popup=this.element.kendoPopup({copyAnchorStyles:!1}).data("kendoPopup")},_sort:function(){var n=e.template(h.templates.menuItem),i=e.spreadsheet.messages.filterMenu,a=[{command:"sort",dir:"asc",text:i.sortAscending,iconClass:"sort-asc"},{command:"sort",dir:"desc",text:i.sortDescending,iconClass:"sort-desc"}],s=t("<ul></ul>",{html:e.render(n,a)}).appendTo(this.element);this.menu=s.kendoMenu({orientation:"vertical",select:function(e){var n={value:t(e.item).data("dir"),sheet:!1,operatingRange:this.options.range.resize({top:1}),column:this.options.column};this.action({command:"SortCommand",options:n})}.bind(this)}).data("kendoMenu")},_appendTemplate:function(n,i,s,r){var o=e.template(n),l=t("<div class='"+i+"'/>").html(o({messages:e.spreadsheet.messages.filterMenu,guid:e.guid(),ns:e.ns}));return this.element.append(l),s&&(s=new a(l,{expanded:r,toggle:this._detailToggle.bind(this)})),e.bind(l,this.viewModel),l},_detailToggle:function(e){this.element.find("[data-role=details]").not(e.sender.element).data("kendoDetails").toggle(!e.show)},_filterByCondition:function(){var e="custom"===this.viewModel.active;this._appendTemplate(h.templates.filterByCondition,h.classNames.filterByCondition,!0,e)},_filterByValue:function(){var t="value"===this.viewModel.active,n=this._appendTemplate(h.templates.filterByValue,h.classNames.filterByValue,!0,t);this.valuesTreeView=n.find("[data-role=treeview]").data("kendoTreeView");var i=c.valuesTree(this.options.range,this.options.column);this.viewModel.set("valuesDataSource",new e.data.HierarchicalDataSource({data:i,accentFoldingFiltering:e.culture().name}))},_actionButtons:function(){this._appendTemplate(h.templates.actionButtons,h.classNames.actionButtons,!1)},_active:function(){var e=this.element.find("[data-role=details]").filter((function(e,n){return t(n).data("kendoDetails").visible()}));e.hasClass(h.classNames.filterByValue)?this.viewModel.set("active","value"):e.hasClass(h.classNames.filterByCondition)&&this.viewModel.set("active","custom")}});e.spreadsheet.FilterMenu=h,t.extend(!0,h,{classNames:i,templates:s})}(window.kendo)})?i.apply(t,a):i)||(e.exports=s)},1612:function(e,t){e.exports=n(1084)},1613:function(e,t){e.exports=n(2715)}})},3324:(e,t,n)=>{e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={exports:{},id:i,loaded:!1};return e[i].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}return n.m=e,n.c=t,n.p="",n(0)}({0:function(e,t,n){n(1614),e.exports=n(1614)},3:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},20:function(e,t){e.exports=n(1657)},1614:function(e,t,n){var i,a,s;n(3),a=[n(20)],void 0===(s="function"==typeof(i=function(){!function(e){var t=e.jQuery,n=e.ui.Widget.extend({init:function(i,a){e.ui.Widget.call(this,i,a);var s=(i=this.element.addClass(n.classNames.wrapper)).width();this.formulaInput=new e.spreadsheet.FormulaInput(t("<div/>").appendTo(i),{formulaBarWidth:s})},destroy:function(){this.formulaInput&&this.formulaInput.destroy(),this.formulaInput=null}});e.spreadsheet.FormulaBar=n,t.extend(!0,n,{classNames:{wrapper:"k-spreadsheet-formula-bar"}})}(window.kendo)})?i.apply(t,a):i)||(e.exports=s)}})},4611:(e,t,n)=>{e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={exports:{},id:i,loaded:!1};return e[i].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}return n.m=e,n.c=t,n.p="",n(0)}({0:function(e,t,n){n(1615),e.exports=n(1615)},3:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},20:function(e,t){e.exports=n(1657)},1615:function(e,t,n){var i,a,s;n(3),a=[n(20)],void 0===(s="function"==typeof(i=function(){var e=kendo.spreadsheet,t=e.CellRef,n=e.RangeRef,i=e.UnionRef,a=e.NameRef,s=e.Ref,r=kendo.Class.extend({init:function(e){this.workbook=e},getRefCells:function(e,r,o,l,u,c){var h,d,f,p;if(e instanceof t)return(h=this.workbook.sheetByName(e.sheet))&&e.valid()?(d=h.formula(e),f=h.range(e.row,e.col).value(),c||null!=d||null!=f?[{formula:d,value:f,row:e.row,col:e.col,sheet:e.sheet,hidden:!!r&&(0===h.columnWidth(e.col)||0===h.rowHeight(e.row))}]:[]):[{value:new kendo.spreadsheet.calc.runtime.CalcError("REF")}];if(e instanceof n){var v=[],m=p=this.workbook.sheetIndex(e.sheet);if(e.endSheet&&p>(m=this.workbook.sheetIndex(e.endSheet))){var g=p;p=m,m=g}if(p<0||m<0||!e.valid())return[{value:new kendo.spreadsheet.calc.runtime.CalcError("REF")}];for(;p<=m;)for(var y=(h=this.workbook.sheetByIndex(p++))._grid.normalize(e.topLeft),b=h._grid.normalize(e.bottomRight),x=h._grid.cellRefIndex(y),_=h._grid.cellRefIndex(b),k=h._properties.iterator("value",x,_),w=y.col;w<=b.col;++w)for(var T=y.row;T<=b.row;++T){var F=h._grid.index(T,w);d=h._properties.get("formula",F),f=k.at(F),(c||null!=d||null!=f)&&v.push({formula:d,value:f,row:T,col:w,sheet:h.name(),hidden:!!r&&(0===h.columnWidth(w)||0===h.rowHeight(T))})}return v}if(e instanceof i){var C=[];for(p=0;p<e.refs.length;++p)C=C.concat(this.getRefCells(e.refs[p],r,o,l,u));return C}if(e instanceof a){var D=this.nameValue(e,o,l,u);return D instanceof s?this.getRefCells(D,r,o,l,u):[{value:null==D?new kendo.spreadsheet.calc.runtime.CalcError("NAME"):D}]}return[]},nameValue:function(e,t,n,i){var a;return e.hasSheet()?a=this.workbook.nameValue(e.print()):(e=e.clone().setSheet(t,!0),null==(a=this.workbook.nameValue(e.print()))&&(a=this.workbook.nameValue(e.name))),a instanceof s&&(a=a.absolute(n,i)),a},getData:function(e,n,i,s,r){var o=e instanceof t;e instanceof a&&(o=this.workbook.nameValue(e.name)instanceof t);var l=this.getRefCells(e,!1,n,i,s,r).map((function(e){var t=e.value;return t instanceof kendo.spreadsheet.calc.runtime.Formula&&(t=t.value),t}));return o?l[0]:l},onFormula:function(e){var t=this.workbook.sheetByName(e.sheet),n=e.row,i=e.col,a=e.value;if(t.formula({row:n,col:i})!==e)return!1;var r=e.arrayFormulaRange;if(r){var o,l,u=a.width,c=a.height;t.forEach(r,(function(e,n){void 0===o&&(o=e,l=n);var i,s=e-o,r=n-l;i=s<c&&r<u?a.get(s,r):new kendo.spreadsheet.calc.runtime.CalcError("N/A"),t._value(e,n,i)}))}else a instanceof s&&(a=this.getData(a,e.sheet,n,i),Array.isArray(a)&&(a=a[0]),void 0===a&&(a=null)),a instanceof kendo.spreadsheet.calc.runtime.Matrix&&(a=a.get(0,0)),t._value(n,i,a);return clearTimeout(t._formulaContextRefresh),t._formulaContextRefresh=setTimeout((function(){t.batch((function(){}),{layout:!0})}),50),!0}}),o=r.extend({onFormula:function(){return!0}});e.FormulaContext=r,e.ValidationFormulaContext=o})?i.apply(t,a):i)||(e.exports=s)}})},4710:(e,t,n)=>{e.exports=function(e){var t={};function n(i){if(t[i])return t[i].exports;var a=t[i]={exports:{},id:i,loaded:!1};return e[i].call(a.exports,a,a.exports,n),a.loaded=!0,a.exports}return n.m=e,n.c=t,n.p="",n(0)}({0:function(e,t,n){n(1616),e.exports=n(1616)},3:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},20:function(e,t){e.exports=n(1657)},1616:function(e,t,n){var i,a,s;n(3),a=[n(20)],void 0===(s="function"==typeof(i=function(){!function(e,t){var n=e.jQuery,i=e.ui.Widget,a=".kendoFormulaInput",s=e.keys,r=["font-family","font-size","font-stretch","font-style","font-weight","letter-spacing","text-transform","line-height"],o={27:"esc",37:"left",39:"right",35:"end",36:"home",32:"spacebar"},l=/(^_|[^a-z0-9]$)/i,u=i.extend({init:function(e,t){i.call(this,e,t),(e=this.element).addClass(u.classNames.wrapper).attr("contenteditable",!0).attr("spellcheck",!1).css("white-space","pre"),t&&t.formulaBarWidth&&e.css("max-width",t.formulaBarWidth-16+"px"),this.options.autoScale&&e.on("input",this.scale.bind(this)),this._highlightedRefs=[],this._formulaSource(),this._formulaList(),this._popup(),this._tooltip(),e.on("keydown",this._keydown.bind(this)).on("keyup",this._keyup.bind(this)).on("blur",this._blur.bind(this)).on("input click",this._input.bind(this)).on("focus",this._focus.bind(this)).on("paste",this._paste.bind(this))},options:{name:"FormulaInput",autoScale:!1,filterOperator:"startswith",scalePadding:30,minLength:1,formulaBarWidth:null},events:["keyup","focus"],enable:function(e){if(void 0===e)return"true"===this.element.attr("contenteditable");e?this.element.attr("contenteditable",e):this.element.removeAttr("contenteditable"),this.element.toggleClass("k-state-disabled",!e)},getPos:function(){var e=this.element[0],n=t.getSelection(),i=r(n.focusNode,n.focusOffset),a=r(n.anchorNode,n.anchorOffset);if(null!=i&&null!=a){if(i>a){var s=i;i=a,a=s}return{begin:i,end:a,collapsed:i==a}}function r(t,n){try{!function e(i){if(i===t)throw n;if(1==i.nodeType)for(var a=i.firstChild;a;a=a.nextSibling)e(a);else 3==i.nodeType&&(n+=i.nodeValue.length)}(e)}catch(e){return e}}},setPos:function(e,n){var i,a,s=this.element[0];if(e=l(s,e),n=null!=n?l(s,n):e,e&&n){var r=document.createRange();r.setStart(e.node,e.pos),r.setEnd(n.node,n.pos);var o=t.getSelection();i=r,a=o.getRangeAt(0),(i.startOffset!=a.startOffset||i.endOffset!=a.endOffset||i.startContainer!=a.endContainer||i.endContainer!=a.endContainer)&&(o.removeAllRanges(),o.addRange(r))}function l(e,t){try{!function e(n){if(3==n.nodeType){var i=n.nodeValue.length;if(i>=t)throw n;t-=i}else if(1==n.nodeType)for(var a=n.firstChild;a;a=a.nextSibling)e(a)}(e)}catch(e){return{node:e,pos:t}}}},end:function(){this.setPos(this.length())},home:function(){this.setPos(0)},select:function(){this.setPos(0,this.length())},length:function(){return this.value().length},_formulaSource:function(){var t,n=[];for(var i in e.spreadsheet.calc.runtime.FUNCS)l.test(i)||(t=i.toUpperCase(),n.push({value:t,text:t}));this.formulaSource=new e.data.DataSource({data:n})},_formulaList:function(){this.list=new e.ui.StaticList(n("<ul />").addClass(u.classNames.listWrapper).insertAfter(this.element),{autoBind:!1,selectable:!0,change:this._formulaListChange.bind(this),dataSource:this.formulaSource,dataValueField:"value",template:"#:data.value#"}),this.list.element.on("mousedown",(function(e){e.preventDefault()}))},_formulaListChange:function(){var e=this._tokenContext();if(e&&!this._mute){var t=e.token,n=this.list.value()[0],i={replace:!0,token:t,end:t.end};e.nextToken&&"("==e.nextToken.value||(n+="("),this._replaceAt(i,n),this.popup.close()}},_popup:function(){this.popup=new e.ui.Popup(this.list.element,{anchor:this.element})},_blur:function(){this.popup.close(),clearTimeout(this._focusId),this.trigger("blur")},_isFormula:function(){return/^=/.test(this.value())},_keydown:function(e){var t=e.keyCode,n=this;o[t]?(n.popup.close(),n._navigated=!0):n._move(t)&&(n._navigated=!0,e.preventDefault()),n._keyDownTimeout=setTimeout(n._syntaxHighlight.bind(n))},_keyup:function(){var e,t=this.popup;this._isFormula()&&!this._navigated&&(e=((this._tokenContext()||{}).token||{}).value,this.filter(e),e&&this.formulaSource.view().length?(t[t.visible()?"position":"open"](),this.list.focusFirst()):t.close()),this._navigated=!1,this._syntaxHighlight(),this.trigger("keyup")},_input:function(){this._syntaxHighlight()},_focus:function(){setTimeout(this._sync.bind(this)),this._focusTimeout=setTimeout(this._syntaxHighlight.bind(this)),this.trigger("focus")},_paste:function(n){n.preventDefault();var i,a=this.getPos();i=e.support.browser.msie?t.clipboardData.getData("Text"):n.originalEvent.clipboardData.getData("text/plain");var s=this.value();s=s.substr(0,a.begin)+i+s.substr(a.end),this.value(s),this.setPos(a.begin+i.length),this.scale()},_move:function(e){var t=this.list,n=this.popup;if(n.visible()){if(e===s.DOWN)return t.focusNext(),t.focus()||t.focusFirst(),!0;if(e===s.UP)return t.focusPrev(),t.focus()||t.focusLast(),!0;if(e===s.ENTER)return t.select(t.focus()),n.close(),!0;if(e===s.TAB)return t.select(t.focus()),n.close(),!0;if(e===s.PAGEUP)return t.focusFirst(),!0;if(e===s.PAGEDOWN)return t.focusLast(),!0}return e===s.ENTER||e===s.TAB},_tokenContext:function(){var t=this.getPos(),n=this.value();if(!n||!t||!t.collapsed)return null;for(var i,a=e.spreadsheet.calc.tokenize(n,this.row(),this.col()),s=0;s<a.length;++s)if(h(i=a[s],t)&&/^(?:str|sym|func)$/.test(i.type))return{token:i,nextToken:a[s+1]};return null},_sync:function(){this._editorToSync&&this.isActive()&&this._editorToSync.value(this.value())},_textContainer:function(){var t=e.getComputedStyles(this.element[0],r);t.position="absolute",t.visibility="hidden",t.whiteSpace="pre",t.top=-3333,t.left=-3333,this._span=n("<span style='white-space: pre'/>").css(t).insertAfter(this.element)},_tooltip:function(){this._cellTooltip=n('<div class="k-widget k-tooltip" style="position:absolute; display:none">A1</div>').insertAfter(this.element)},tooltip:function(e){this._cellTooltip.text(e)},toggleTooltip:function(e){this._cellTooltip.toggle(e)},isActive:function(){return this.element[0]===e._activeElement()},filter:function(e){!e||e.length<this.options.minLength||(this._mute=!0,this.list.select(-1),this._mute=!1,this.formulaSource.filter({field:this.list.options.dataValueField,operator:this.options.filterOperator,value:e}))},hide:function(){this.enable(!1),this.element.hide(),this._cellTooltip.hide()},show:function(){this.enable(!0),this.element.show()},row:function(){if(this.activeCell)return this.activeCell.row},col:function(){if(this.activeCell)return this.activeCell.col},position:function(e){e&&(this.show(),this.element.css({top:e.top+1+"px",left:e.left+1+"px"}),this._cellTooltip.css({top:e.top-this._cellTooltip.height()-10+"px",left:e.left}))},resize:function(e){e&&this.element.css({width:e.width-1,height:e.height-1})},canInsertRef:function(e){return this._canInsertRef(e)},_canInsertRef:function(t){if(this.popup.visible())return null;var n,i,a=t,s=this.getPos();if(s&&this._isFormula()){if(0===s.begin)return null;n=e.spreadsheet.calc.tokenize(this.value(),this.row(),this.col());for(var r=0;r<n.length;++r){if(h(i=n[r],s))return l(i);if(o(i))return u(n[r-1],i)}return u(i,null)}return null;function o(e){return e.begin>s.begin}function l(e){if(e){if(/^(?:num|str|bool|sym|ref)$/.test(e.type))return{replace:!0,token:e,end:e.end};if(/^(?:op|punc|startexp)$/.test(e.type))return e.end==s.end?u(e,n[r+1]):u(n[r-1],e)}}function u(e,t){if(null==e)return null;if(null==t)return/^(?:op|startexp)$/.test(e.type)||c(e.value)?{token:e,end:s.end}:null;if(a){if("op"==e.type&&/^(?:punc|op)$/.test(t.type))return{token:e,end:s.end}}else{if("startexp"==e.type)return{token:e,end:s.end};if(/^(?:op|punc)$/.test(e.type)&&/^[,;({]$/.test(e.value))return{token:e,end:s.end};if(/^(?:ref|sym)/.test(e.type))return{token:e,replace:!0,end:e.end};if(/^(?:ref|sym)/.test(t.type))return{token:t,replace:!0,end:t.end}}return!1}},refAtPoint:function(e){var t=this._canInsertRef();if(t){var n=e.selection()._ref.simplify().clone().relative(0,0,3);e!==this.activeSheet&&(n=n.setSheet(e.name(),!0)),this._replaceAt(t,n.print(0,0))}},_replaceAt:function(e,t){var n=this.value(),i=e.token,a=n.substr(e.end),s=(n=n.substr(0,e.replace?i.begin:e.end)+t).length;n+=a,this._value(n),this.setPos(s),this.scale(),this._syntaxHighlight()},syncWith:function(t){var n,i=this,s="input"+a,r=i._sync.bind(i);e.support.browser.msie&&(s="keydown"+a,n=function(){setTimeout(r)}),i._editorToSync=t,i.element.off(s).on(s,n||r)},scale:function(){var e,t,n=this.element;this._span||this._textContainer(),this._span.html(n.html()),e=this._span.width()+this.options.scalePadding,t=this._span.height(),e>n.width()&&n.width(e),t>n.height()&&n.height(t),this._sync()},_value:function(e){this.element.text(e)},value:function(e){if(void 0===e)return this.element[0].innerText.replace(/\n$/,"");this._value(e),this._syntaxHighlight()},highlightedRefs:function(){return this._highlightedRefs.slice()},_syntaxHighlight:function(){var t=this.getPos(),n=this.value(),i=e.spreadsheet.Pane.classNames.series,a=[],s=0,r=[],o=[];if(!t||t.collapsed){if(!/^=/.test(n))return this._highlightedRefs.length&&(this._highlightedRefs=[],this.element.text(n)),void(this.popup&&this.popup.close());(o=e.spreadsheet.calc.tokenize(n,this.row(),this.col())).forEach((function(n){if(n.active=!1,n.cls=["k-syntax-"+n.type],"ref"==n.type&&(n.colorClass=i[s++%i.length],n.cls.push(n.colorClass),a.push(n)),t&&"punc"==n.type)if(c(n.value))r.unshift(n);else if(")"==(l=n.value)||"]"==l||"}"==l){var o=r.shift();o?function(e,t){return"("==t?")"==e:"["==t?"]"==e:"{"==t&&"}"==e}(n.value,o.value)?(h(n,t)||h(o,t))&&(n.cls.push("k-syntax-paren-match"),o.cls.push("k-syntax-paren-match")):(n.cls.push("k-syntax-error"),o.cls.push("k-syntax-error")):n.cls.push("k-syntax-error")}var l,u;t&&h(n,t)&&(n.cls.push("k-syntax-at-point"),n.active=!0),"func"!=n.type||(u=n.value,e.spreadsheet.calc.runtime.FUNCS[u.toLowerCase()])||t&&h(n,t)||n.cls.push("k-syntax-error")})),o.reverse().forEach((function(t){var i=t.begin,a=t.end,s=e.htmlEncode(n.substring(i,a));n=n.substr(0,i)+"<span class='"+t.cls.join(" ")+"'>"+s+"</span>"+n.substr(a)})),this.element.html(n),t&&this.setPos(t.begin,t.end),this._highlightedRefs=a}},destroy:function(){this._editorToSync=null,this.element.off(a),clearTimeout(this._focusTimeout),clearTimeout(this._keyDownTimeout),this._cellTooltip=null,this._span=null,this.popup.destroy(),this.popup=null,i.fn.destroy.call(this)},insertNewline:function(){var e=this.value(),t=this.getPos(),n=t.end==e.length;e=e.substr(0,t.begin)+(n?"\n\n":"\n"+e.substr(t.end)),this.value(e),this.setPos(t.begin+1)}});function c(e){return"("==e||"["==e||"{"==e}function h(e,t){return e.begin<=t.begin&&e.end>=t.end}e.spreadsheet.FormulaInput=u,n.extend(!0,u,{classNames:{wrapper:"k-spreadsheet-formula-input",listWrapper:"k-spreadsheet-formula-list"}})}(kendo,window)})?i.apply(t,a):i)||(e.exports=s)}})}}]);