(self.webpackChunk_5_112_1332=self.webpackChunk_5_112_1332||[]).push([[2313],{6441:(e,t,i)=>{e.exports=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}return i.m=e,i.c=t,i.p="",i(0)}({0:function(e,t,i){i(1596),e.exports=i(1596)},3:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},20:function(e,t){e.exports=i(1657)},1596:function(e,t,i){var n,o,r;i(3),o=[i(20)],void 0===(r="function"==typeof(n=function(){!function(e){var t=e.jQuery,i=e.spreadsheet.CellRef,n=e.Class.extend({init:function(t){this._content={},this._externalContent={},this._internalContent={},this.workbook=t,this.origin=e.spreadsheet.NULLREF,this.iframe=document.createElement("iframe"),this.iframe.className="k-spreadsheet-clipboard-paste",this.iframe.setAttribute("title","Spreadsheet clipboard iframe"),this.menuInvoked=!1,this._uid=e.guid(),document.body.appendChild(this.iframe)},destroy:function(){document.body.removeChild(this.iframe)},canCopy:function(){var t={canCopy:!0},i=this.workbook.activeSheet().select();return i===e.spreadsheet.NULLREF&&(t.canCopy=!1),i instanceof e.spreadsheet.UnionRef&&(t.canCopy=!1,t.multiSelection=!0),this.menuInvoked&&(t.canCopy=!1,t.menuInvoked=!0),t},canPaste:function(){var e=this.workbook.activeSheet(),t=this.pasteRef(),i={canPaste:!0,pasteOnMerged:!1,pasteOnDisabled:!1};return e.range(t).enable()||(i.canPaste=!1,i.pasteOnDisabled=!0),t.eq(e.unionWithMerged(t))||(i.canPaste=!1,i.pasteOnMerged=!0),this.menuInvoked&&(i.canPaste=!1,i.menuInvoked=!0),(t.bottomRight.row>=e._rows._count||t.bottomRight.col>=e._columns._count)&&(i.canPaste=!1,i.overflow=!0),i},intersectsMerged:function(){var e=this.workbook.activeSheet();this.parse(),this.origin=this._content.origRef;var t=this.pasteRef();return!t.eq(e.unionWithMerged(t))},copy:function(){var e=this.workbook.activeSheet();this.origin=e.select(),this._internalContent=e.selection().getState(),delete this._externalContent.html,delete this._externalContent.plain},cut:function(){var e=this.workbook.activeSheet();this.copy(),e.range(e.select()).clear()},pasteRef:function(){var t=this.workbook.activeSheet();if(this.origin===e.spreadsheet.NULLREF)return t.select();var i=t.activeCell().first(),n=this.origin.first(),o=n.row-i.row,r=n.col-i.col;return this.origin.relative(o,r,3)},paste:function(){var e=this.workbook.activeSheet(),t=this.pasteRef();e.range(t).setState(this._content,this),e.triggerChange({recalc:!0,ref:t})},external:function(e){if(!e||!e.html&&!e.plain)return this._externalContent;this._externalContent=e},isExternal:function(){return!this._isInternal()},parse:function(){var t=o();if(this._isInternal())t=this._internalContent;else{var n=this._externalContent;if(n.html){var a=this.iframe.contentWindow.document;a.open(),a.write(n.html),a.close();var c=a.querySelector("table");t=c?function(t){for(var n=o(),a=[],h=0,c=0,l=0;l<t.rows.length;++l)a.push([]);for(var d=new e.spreadsheet.calc.runtime.Matrix,u=new e.spreadsheet.calc.runtime.Matrix,f=0;f<t.rows.length;++f,++h){var p=t.rows[f];c=0;for(var g=0;g<p.cells.length;++g){for(var v=p.cells[g],m=v.rowSpan,_=v.colSpan;a[h][c];)c++;var w=v.getAttribute("style"),b=/mso-ignore:colspan/.test(w);r(n,h,c,s(h,c,v,d,u)),(m>1||_>1&&!b)&&n.mergedCells.push(new e.spreadsheet.RangeRef(new i(h,c),new i(h+m-1,c+_-1)).toString());for(var x=h+m;--x>=h;)for(var k=c+_;--k>=c;)x<a.length&&(a[x][k]=!0,x==h&&k==c||r(n,x,k,{}))}}return n}(c):h(n.plain)}else t=h(n.plain);this.origin=t.origRef}this._content=t},_isInternal:function(){if(void 0===this._externalContent.html)return!0;var e=!!t("<div/>").html(this._externalContent.html).find("table.kendo-clipboard-"+this._uid).length,i=!!t("<div/>").html(this._externalContent.plain).find("table.kendo-clipboard-"+this._uid).length;return e||i}});function o(){var e=new i(0,0,0);return{ref:e,mergedCells:[],data:[],foreign:!0,origRef:e.toRangeRef()}}function r(e,t,i,n){var o=e.data||(e.data=[]);o[t]||(o[t]=[]),o[t][i]=n;var r=e.origRef.bottomRight;r.row=Math.max(r.row,t),r.col=Math.max(r.col,i)}function a(e){return e.replace(/^-(?:ms|moz|webkit)-/,"")}function s(e,t,i,n,o){var r=window.getComputedStyle(i),s=i.innerText.replace(/\t$/,""),h=function(e){var t={};return["borderBottom","borderRight","borderLeft","borderTop"].forEach((function(i){t[i]="none"==e[i+"Style"]?null:{size:1,color:e[i+"Color"]}})),t}(r),c={value:""===s?null:s,borderTop:h.borderTop||n.get(e,t)||null,borderBottom:h.borderBottom||n.get(e+1,t)||null,borderLeft:h.borderLeft||o.get(e,t)||null,borderRight:h.borderRight||o.get(e,t+1)||null,fontSize:parseInt(r["font-size"],10)};return n.set(e,t,c.borderTop),n.set(e+1,t,c.borderBottom),o.set(e,t,c.borderLeft),o.set(e,t+1,c.borderRight),"rgb(0, 0, 0)"!==r["background-color"]&&"rgba(0, 0, 0, 0)"!==r["background-color"]&&(c.background=r["background-color"]),"rgb(0, 0, 0)"!==r.color&&"rgba(0, 0, 0, 0)"!==r.color&&(c.color=r.color),"underline"==r["text-decoration"]&&(c.underline=!0),"italic"==r["font-style"]&&(c.italic=!0),"bold"==r["font-weight"]&&(c.bold=!0),"right"!==a(r["text-align"])&&(c.textAlign=a(r["text-align"])),"middle"!==r["vertical-align"]&&(c.verticalAlign=r["vertical-align"]),"normal"!==r["word-wrap"]&&(c.wrap=!0),c}function h(e){var t=o();if(-1===e.indexOf("\t")&&-1==e.indexOf("\n"))r(t,0,0,{value:e});else for(var i=e.split("\n"),n=0;n<i.length;n++)for(var a=i[n].split("\t"),s=0;s<a.length;s++)r(t,n,s,{value:a[s]});return t}e.spreadsheet.Clipboard=n}(kendo)})?n.apply(t,o):n)||(e.exports=r)}})},6715:(e,t,i)=>{e.exports=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}return i.m=e,i.c=t,i.p="",i(0)}({0:function(e,t,i){i(1597),e.exports=i(1597)},3:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},20:function(e,t){e.exports=i(1657)},968:function(e,t){e.exports=i(7383)},1578:function(e,t){e.exports=i(5252)},1597:function(e,t,i){var n,o,r;i(3),o=[i(20),i(1578),i(968),i(1598),i(1599)],void 0===(r="function"==typeof(n=function(){!function(e){var t=e.jQuery,i="autoFill",n="clear",o="cut",r="edit",a="paste",s="validation",h=e.spreadsheet.Command=e.Class.extend({init:function(e){this.options=e,this._workbook=e.workbook,this._property=e&&e.property,this._state={}},range:function(e){return void 0!==e&&this._setRange(e),this._range},_setRange:function(e){this._range=e},redo:function(){this.range().select(),this.exec()},undo:function(){this.setState(this._state)},getState:function(){this._state=this.range().getState(this._property)},setState:function(e){this.range().setState(e)},rejectState:function(e){return this.undo(),{title:e.title,body:e.message,reason:"error",type:"validationError"}},_forEachCell:function(e){var t=this.range();t._ref.forEach(function(i){t.sheet().forEach(i.toRangeRef(),e.bind(this))}.bind(this))},usesImage:function(){return!1}});e.spreadsheet.DrawingUpdateCommand=h.extend({init:function(e){this._sheet=e.sheet,this._drawing=e.drawing,this._orig=this._drawing.clone(),this._previous=e.previous},exec:function(){},undo:function(){this._drawing.reset(this._previous),this._sheet._activeDrawing=this._drawing,this._sheet.triggerChange({layout:!0})},redo:function(){this._drawing.reset(this._orig),this._sheet._activeDrawing=this._drawing,this._sheet.triggerChange({layout:!0})},usesImage:function(e){return this._drawing.image===e||this._orig.image===e||this._previous.image===e}});var c=h.extend({init:function(e){h.fn.init.call(this,e),this._drawing=e.drawing},usesImage:function(e){return this._drawing.image===e}});e.spreadsheet.InsertImageCommand=c.extend({init:function(e){c.fn.init.call(this,e),this._blob=e.blob,this._width=e.width,this._height=e.height},exec:function(){var e=this.range(),t=e.sheet(),i=this._width,n=this._height,o=i/n;i>n?n=(i=Math.min(i,300))/o:i=(n=Math.min(n,300))*o,this._drawing=t.addDrawing({topLeftCell:e.topLeft(),offsetX:5,offsetY:5,width:i,height:n,opacity:1,image:this._workbook.addImage(this._blob)},!0),this._blob=null},undo:function(){var e=this.range().sheet();e._activeDrawing=null,e.removeDrawing(this._drawing)},redo:function(){var e=this.range().sheet();e._activeDrawing=this._drawing,e.addDrawing(this._drawing)}}),e.spreadsheet.DeleteDrawingCommand=c.extend({exec:function(){var e=this.range().sheet();e._activeDrawing=null,e.removeDrawing(this._drawing)},undo:function(){var e=this.range().sheet();e._activeDrawing=this._drawing,e.addDrawing(this._drawing)},redo:function(){this.exec()}});var l=c.extend({exec:function(){var e=this.range().sheet();this._origIndex=e._drawings.indexOf(this._drawing),e._drawings.splice(this._origIndex,1),this._newIndex=this._reorder(),e._drawings.splice(this._newIndex,0,this._drawing),e.triggerChange({drawings:!0})},undo:function(){var e=this.range().sheet();e._drawings.splice(this._newIndex,1),e._drawings.splice(this._origIndex,0,this._drawing),e.triggerChange({drawings:!0})}});e.spreadsheet.BringToFrontCommand=l.extend({_reorder:function(){return this.range().sheet()._drawings.length}}),e.spreadsheet.SendToBackCommand=l.extend({_reorder:function(){return 0}});var d=h.extend({init:function(e){h.fn.init.call(this,e),this._target=e.target,this._value=e.value},exec:function(){this.getState(),this.setState(this._value)}});e.spreadsheet.ColumnWidthCommand=d.extend({getState:function(){this._state=this.range().sheet().columnWidth(this._target)},setState:function(e){this.range().sheet().columnWidth(this._target,e)}}),e.spreadsheet.RowHeightCommand=d.extend({getState:function(){this._state=this.range().sheet().rowHeight(this._target)},setState:function(e){this.range().sheet().rowHeight(this._target,e)}}),e.spreadsheet.HyperlinkCommand=h.extend({init:function(e){h.fn.init.call(this,e),this._link=e.link},exec:function(){var e=this.range();this._prevLink=e.link(),this._prevUnderline=e.underline(),e.link(this._link),e.underline(!0),null==e.value()&&(this._hasSetValue=!0,e.value(this._link))},undo:function(){var e=this.range();e.link(this._prevLink),e.underline(this._prevUnderline),this._hasSetValue&&e.value(null)}}),e.spreadsheet.GridLinesChangeCommand=d.extend({getState:function(){this._state=this._range.sheet().showGridLines()},setState:function(e){this._range.sheet().showGridLines(e)}});var u=e.spreadsheet.PropertyChangeCommand=h.extend({_setRange:function(e){h.prototype._setRange.call(this,e.skipHiddenCells())},init:function(e){h.fn.init.call(this,e),this._value=e.value},exec:function(){var e=this.range();e.enable()&&(this.getState(),"format"===this.options.property&&this._workbook.trigger("changeFormat",{range:e}),e[this._property](this._value))}});e.spreadsheet.ClearContentCommand=h.extend({exec:function(){var e,t,i,o,r,a=[];return this.range().enable()?this.range().canEditArrayFormula()?(this.getState(),(e=this.range().skipHiddenCells())._ref.refs&&e._ref.refs.length>1?e._ref.refs.forEach((function(t){r=e.sheet().range(t),a=a.concat(r.values())})):a=e.values(),i=[],a.forEach((function(e){t=[],e.forEach((function(){t.push(null)})),i.push(t)})),e.sheet().trigger("changing",{data:i,range:e,changeType:n})?void 0:(e.clearContent(),(o=e._getValidationState())?this.rejectState(o):void 0)):{reason:"error",type:"intersectsArray"}:{reason:"error",type:"cannotModifyDisabled"}},undo:function(){var e,t=this.range().skipHiddenCells(),i=t.sheet(),o=this._state.data,r=[];o.forEach((function(t){e=[],t.forEach((function(t){e.push(t.value)})),r.push(e)})),i.trigger("changing",{data:r,range:t,changeType:n})||this.setState(this._state)}}),e.spreadsheet.EditCommand=u.extend({init:function(e){e.property=e.property||"input",u.fn.init.call(this,e)},_setRange:function(e){u.prototype._setRange.apply(this,arguments),this._editRange=this.options.arrayFormula?e:e.sheet().activeCellSelection()},getState:function(){this._state=this.range().getState()},exec:function(){return this.range().sheet().withCultureDecimals(this._exec.bind(this))},undo:function(){var e=this._editRange,t=this._state;e.sheet().trigger("changing",{data:t.data[0][0].value,range:e,changeType:r})||this.setState(this._state)},_exec:function(){var t=this.options.arrayFormula,i=this._editRange;if(!i.enable())return{reason:"error",type:"rangeDisabled"};if(!i.canEditArrayFormula())return{reason:"error",type:"intersectsArray"};var n=this._value;if(this.getState(),!this.range().sheet().trigger("changing",{data:n,range:this._editRange,changeType:r}))if("value"!=this._property)try{i.link(null),""===n?i.value(null):(i.input(n,{arrayFormula:t}),/\n/.test(i.value())&&i.wrap(!0)),i._adjustRowHeight();var o=i._getValidationState();if(o)return this.rejectState(o)}catch(t){if(t instanceof e.spreadsheet.calc.ParseError)return{title:"Error in formula",body:t+"",reason:"error"};throw t}else i.value(n)}}),e.spreadsheet.InsertCommentCommand=u.extend({init:function(e){e.property="comment",u.fn.init.call(this,e)}}),e.spreadsheet.TextWrapCommand=u.extend({init:function(e){e.property="wrap",u.fn.init.call(this,e),this._value=e.value},getState:function(){var e={};this.range().forEachRow((function(t){var i=t.topLeft().row;e[i]=t.sheet().rowHeight(i)})),this._state=this.range().getState(this._property),this._rowHeight=e},undo:function(){var e=this.range().sheet(),t=this._rowHeight;for(var i in this.range().setState(this._state),t)e.rowHeight(i,t[i])}}),e.spreadsheet.AdjustDecimalsCommand=h.extend({init:function(e){this._delta=e.value,e.property="format",h.fn.init.call(this,e)},exec:function(){var t=this.range().sheet(),i=this._delta,n=e.spreadsheet.formatting;this.getState(),t.batch(function(){this.range().forEachCell((function(e,o,r){var a=r.format;if(!a){var s=r.value;"number"==typeof s&&/\./.test(s)&&(a="0."+String(s).split(".")[1].replace(/\d/g,"0"))}(a||i>0)&&(a=n.adjustDecimals(a||"0",i),t.range(e,o).format(a))}))}.bind(this))}}),e.spreadsheet.BorderChangeCommand=h.extend({init:function(e){e.property="border",h.fn.init.call(this,e),this._type=e.border,this._style=e.style},_batch:function(e){return this.range().sheet().batch(e,{})},exec:function(){var e=this;e.getState(),e._batch((function(){e[e._type](e._style)}))},noBorders:function(){this.range().insideBorders(null),this.outsideBorders(null)},allBorders:function(e){this.range().insideBorders(e),this.outsideBorders(e)},leftBorder:function(e){this.range().leftColumn().borderLeft(e)},rightBorder:function(e){this.range().rightColumn().borderRight(e)},topBorder:function(e){this.range().topRow().borderTop(e)},bottomBorder:function(e){this.range().bottomRow().borderBottom(e)},outsideBorders:function(e){var t=this.range();t.leftColumn().borderLeft(e),t.topRow().borderTop(e),t.rightColumn().borderRight(e),t.bottomRow().borderBottom(e)},insideBorders:function(e){this.range().insideBorders(e),this.outsideBorders(null)},insideHorizontalBorders:function(e){this.range().insideHorizontalBorders(e)},insideVerticalBorders:function(e){this.range().insideVerticalBorders(e)}}),e.spreadsheet.MergeCellCommand=h.extend({init:function(e){h.fn.init.call(this,e),this._type=e.value},exec:function(){this.getState(),this[this._type]()},activate:function(e){this.range().sheet().activeCell(e)},getState:function(){this._state=this.range().getState()},undo:function(){"unmerge"!==this._type&&(this.range().unmerge(),this.activate(this.range().topLeft())),this.range().setState(this._state)},cells:function(){var e=this.range(),t=e._ref;e.merge(),this.activate(t)},horizontally:function(){var e=this.range().topRow()._ref;this.range().forEachRow((function(e){e.merge()})),this.activate(e)},vertically:function(){var e=this.range().leftColumn()._ref;this.range().forEachColumn((function(e){e.merge()})),this.activate(e)},unmerge:function(){var e=this.range(),t=e._ref.topLeft;e.unmerge(),this.activate(t)}}),e.spreadsheet.FreezePanesCommand=h.extend({init:function(e){h.fn.init.call(this,e),this._type=e.value},exec:function(){this.getState(),this._topLeft=this.range().topLeft(),this[this._type]()},getState:function(){this._state=this.range().sheet().getState()},undo:function(){this.range().sheet().setState(this._state)},panes:function(){var e=this._topLeft;this.range().sheet().frozenColumns(e.col).frozenRows(e.row)},rows:function(){var e=this._topLeft;this.range().sheet().frozenRows(e.row)},columns:function(){var e=this._topLeft;this.range().sheet().frozenColumns(e.col)},unfreeze:function(){this.range().sheet().frozenRows(0).frozenColumns(0)}}),e.spreadsheet.PasteCommand=h.extend({init:function(t){h.fn.init.call(this,t),this._clipboard=t.workbook.clipboard(),this._clipboard.parse(),this._event=t.event,this._clipboardContent=this._clipboard._content,this._clipboardPasteRef=this._clipboard.pasteRef(),this._sheet=this._workbook.activeSheet(),this._range=this._sheet.selection?this._sheet.selection():this._sheet.range(this._clipboard.pasteRef()),this._state=this._range.getState(),this._targetRangeRefs=this._range._ref instanceof e.spreadsheet.UnionRef?this._range._ref.refs:[this._range._ref]},exec:function(){return this.range().sheet().withCultureDecimals(this._exec.bind(this))},undo:function(){var e=this._sheet,t=this._range;e.trigger("changing",{data:this._state.data,range:t,changeType:a})||this.setState(this._state)},_exec:function(){var e=this._clipboard.canPaste();if(!e.canPaste)return e.menuInvoked?{reason:"error",type:"useKeyboard"}:e.pasteOnMerged?{reason:"error",type:"modifyMerged"}:e.overflow?{reason:"error",type:"overflow"}:e.pasteOnDisabled?(this._event.preventDefault(),{reason:"error",type:"cannotModifyDisabled"}):{reason:"error"};var t=this._sheet,i=this._range;this._workbook.trigger("paste",{range:i,clipboardContent:this._clipboardContent})||t.trigger("changing",{data:this._clipboardContent.data,range:i,changeType:a})?this._event.preventDefault():this._processPaste()},_adjustPasteTarget:function(t,i,n){var o,r,a,s,h,c,l=this,d=l._targetRangeRefs,u=l._sheet,f=e.spreadsheet.RangeRef,p=e.spreadsheet.UnionRef,g=[];for(c=0;c<d.length;c+=1)a=d[c],h=t[c],o=new f(s=a.topLeft,{row:h.rows*i+s.row-1,col:h.cols*n+s.col-1}),g.push(o);1===g.length?r=u.range(o):(g.sort((function(e,t){var i=0,n=e.topLeft,o=t.topLeft;return n.row>o.row?i=1:n.row<o.row?i=-1:n.col>o.col?i=1:n.col<o.col&&(i=-1),i})),r=u.range(new p(g))),r.select(),l._range=r,l._state=l._range.getState()},_processPaste:function(){var e,t=this,i=t._sheet,n=t._clipboardContent,o=t._range,r=n.data,a=r.length,s=r[0].length,h=t._targetRangeRefs,c=t._targetRanges(a,s);t._adjustPasteTarget(c,a,s),i.batch((function(){for(e=0;e<h.length;e++)t._populateTargetRange(h[e],a,s,c[e])})),o._adjustRowHeight()},_populateTargetRange:function(e,t,i,n){var o,r,a=e.topLeft;for(o=0;o<n.rows;o++)for(r=0;r<n.cols;r++)this._sheet.range(a.row+t*o,a.col+i*r).setState(this._clipboardContent,this._clipboard)},_targetRangeDimensions:function(e,t,i){var n=e.topLeft,o=e.bottomRight,r=o.row-n.row+1,a=o.col-n.col+1,s=1,h=1;return r%t==0&&a%i==0&&(s=r/t,h=a/i),{rows:s,cols:h}},_targetRanges:function(e,t){var i,n=this._targetRangeRefs,o=[];for(i=0;i<n.length;i++)o.push(this._targetRangeDimensions(n[i],e,t));return o}}),e.spreadsheet.AdjustRowHeightCommand=h.extend({exec:function(){var e=this.options,t=this._workbook.activeSheet();(e.range||t.range(e.rowIndex))._adjustRowHeight()}}),e.spreadsheet.ToolbarPasteCommand=h.extend({exec:function(){if(!e.support.clipboard.paste)return{reason:"error",type:"useKeyboard"};this._workbook._view.clipboard.focus().select(),document.execCommand("paste")}}),e.spreadsheet.CutCommand=h.extend({_eventType:"cut",init:function(e){h.fn.init.call(this,e),this._clipboard=e.workbook.clipboard(),this._event=e.event},exec:function(){var e,t=this._clipboard.canCopy(),i=[];if(!t.canCopy)return t.menuInvoked?{reason:"error",type:"useKeyboard"}:t.multiSelection?{reason:"error",type:"unsupportedSelection"}:void 0;var n=this._workbook.activeSheet().selection();if("cut"==this._eventType){if(!n.enable())return this._event.preventDefault(),{reason:"error",type:"cannotModifyDisabled"};this.getState()}if(this._workbook.trigger(this._eventType,{range:n}))this._event.preventDefault();else if("cut"==this._eventType){if(n.values().forEach((function(t){e=[],t.forEach((function(){e.push({})})),i.push(e)})),n.sheet().trigger("changing",{data:i,range:n,changeType:o}))return;this._clipboard.cut()}else this._clipboard.copy()},undo:function(){var e=this.range();e.sheet().trigger("changing",{data:this._state.data,range:e,changeType:o})||this.setState(this._state)}}),e.spreadsheet.CopyCommand=e.spreadsheet.CutCommand.extend({_eventType:"copy",undo:t.noop}),e.spreadsheet.ToolbarCopyCommand=h.extend({init:function(e){h.fn.init.call(this,e),this._clipboard=e.workbook.clipboard()},undo:t.noop,exec:function(){if(!e.support.clipboard.copy)return{reason:"error",type:"useKeyboard"};document.execCommand("copy")}}),e.spreadsheet.AutoFillCommand=h.extend({init:function(e){h.fn.init.call(this,e)},origin:function(e){this._origin=e},exec:function(){var t,n=this.range();if(!n.enable())return{reason:"error",type:"rangeDisabled"};if(n.intersectingArrayFormula())return{reason:"error",type:"intersectsArray"};this.getState();try{if(t=n._previewFillFrom(this._origin),n.sheet().trigger("changing",{data:t.props,range:t.dest,changeType:i}))return;t.dest._properties(t.props,!0)}catch(t){if(t instanceof e.spreadsheet.Range.FillError)return{reason:"error",type:t.code};throw t}},undo:function(){var e=this.range(),t=this._state;e.sheet().trigger("changing",{data:t.data,range:e,changeType:i})||this.setState(this._state)}}),e.spreadsheet.ToolbarCutCommand=h.extend({cannotUndo:!0,init:function(e){h.fn.init.call(this,e),this._clipboard=e.workbook.clipboard()},exec:function(){if(!e.support.clipboard.copy)return{reason:"error",type:"useKeyboard"};document.execCommand("cut")}}),e.spreadsheet.FilterCommand=h.extend({undo:function(){this.range().filter(this._state)},exec:function(){var e=this.range();this._state=e.hasFilter(),e.filter(!this._state)}}),e.spreadsheet.SortCommand=h.extend({undo:function(){this.range().sheet().setState(this._state)},exec:function(){var e=this.range(),t=e.sheet(),i=t.activeCell(),n=this.options.sheet?i.topLeft.col:this.options.column||0,o="asc"===this.options.value;this._state=t.getState(),this.options.sheet&&(e=this.expandRange());var r=e.cantSort();if(r)return{reason:"error",type:r.code};e.sort({column:n,ascending:o})},expandRange:function(){var t=this.range().sheet();return new e.spreadsheet.Range(t._sheetRef,t)}});var f=e.spreadsheet.ApplyFilterCommand=h.extend({column:function(){return this.options.column||0},undo:function(){this.range().sheet().clearFilter(this.column()),this._state.length&&this.range().filter(this._state)},getState:function(){var e=this.range().sheet().filter();e&&(this._state=e.columns.filter(function(e){return e.index==this.column()}.bind(this)))},exec:function(){var t,i,n=this.range(),o=this.column(),r=n.sheet().filter(),a=!1;this.options.valueFilter?i={column:o,filter:new e.spreadsheet.ValueFilter(this.options.valueFilter)}:this.options.customFilter&&(i={column:o,filter:new e.spreadsheet.CustomFilter(this.options.customFilter)}),this.getState(),r&&r.ref.eq(n._ref)&&r.columns.length?(r.columns.forEach((function(e){e.index===o&&(a=!0)})),t=r.columns.map((function(e){return e.index===o?i:{column:e.index,filter:e.filter}})),a||t.push(i)):t=i,n.filter(t)}});e.spreadsheet.ClearFilterCommand=f.extend({exec:function(){var e=this.range(),t=this.column();this.getState(),e.clearFilter(t)}}),e.spreadsheet.HideLineCommand=h.extend({init:function(e){h.fn.init.call(this,e),this.axis=e.axis},undo:function(){this.range().sheet().setAxisState(this._state)},exec:function(){var e=this.range().sheet();this._state=e.getAxisState(),"row"==this.axis?e.axisManager().hideSelectedRows():e.axisManager().hideSelectedColumns()}}),e.spreadsheet.UnHideLineCommand=e.spreadsheet.HideLineCommand.extend({exec:function(){var e=this.range().sheet();this._state=e.getAxisState(),"row"==this.axis?e.axisManager().unhideSelectedRows():e.axisManager().unhideSelectedColumns()}});var p=h.extend({exec:function(){this._expandedRange=this._expand(this.range()),this._state=this._expandedRange.getState(),this._indexes=this._exec(this._expandedRange.sheet())},undo:function(){var e=this,t=e._expandedRange,i=t.sheet();i.batch((function(){e._indexes.forEach((function(t){e._undoOne(i,t),i._restoreModifiedFormulas(t.formulas)})),t.setState(e._state)}),{layout:!0,recalc:!0,ref:t._ref})}});e.spreadsheet.DeleteRowCommand=p.extend({_expand:function(e){return e.resize({left:-1/0,right:1/0})},_exec:function(e){return e.axisManager().deleteSelectedRows()},_undoOne:function(e,t){e.insertRow(t.index),e.rowHeight(t.index,t.height)}}),e.spreadsheet.DeleteColumnCommand=p.extend({_expand:function(e){return e.resize({top:-1/0,bottom:1/0})},_exec:function(e){return e.axisManager().deleteSelectedColumns()},_undoOne:function(e,t){e.insertColumn(t.index),e.columnWidth(t.index,t.width)}});var g=h.extend({init:function(e){h.fn.init.call(this,e),this._value=e.value},undo:function(){var e=this,t=e.range().sheet();t.batch((function(){for(var i=e._pos.count;--i>=0;)e._undoOne(t,e._pos.base)}),{layout:!0,recalc:!0})}});e.spreadsheet.AddColumnCommand=g.extend({exec:function(){var e=this._value,t=this.range().sheet(),i=t.axisManager().preventAddColumn();if(i||"right"!==e||(i=t.axisManager().preventAddColumnAfterLast()),i)return i;this._pos="left"===e?t.axisManager().addColumnLeft():t.axisManager().addColumnRight()},_undoOne:function(e,t){e.deleteColumn(t)}}),e.spreadsheet.AddRowCommand=g.extend({exec:function(){var e=this._value,t=this.range().sheet(),i=t.axisManager().preventAddRow();if(i||"below"!==e||(i=t.axisManager().preventAddRowAfterLast()),i)return i;this._pos="above"===e?t.axisManager().addRowAbove():t.axisManager().addRowBelow()},_undoOne:function(e,t){e.deleteRow(t)}}),e.spreadsheet.EditValidationCommand=h.extend({init:function(e){h.fn.init.call(this,e),this._value=e.value},exec:function(){var t=this,i=t.range().sheet();if(this.getState(),!i.trigger("changing",{data:t._value,range:t.range(),changeType:s}))try{i.withCultureDecimals((function(){t.range().validation(t._value)}))}catch(t){if(t instanceof e.spreadsheet.calc.ParseError)return{title:"Error in formula",body:t+"",reason:"error"};throw t}},undo:function(){var e=this.range(),t=this._state;e.sheet().trigger("changing",{data:t.data[0][0].validation,range:e,changeType:s})||this.setState(this._state)}}),e.spreadsheet.OpenCommand=h.extend({cannotUndo:!0,exec:function(){if(null===this.options.file.name.match(/.xlsx$/i))return{reason:"error",type:"openUnsupported"};var e=this.options.workbook;e.fromFile(this.options.file).then((function(){var t=e.excelImportErrors;t&&t.length&&e._view.openDialog("importError",{errors:t})}))}}),e.spreadsheet.SaveAsCommand=h.extend({cannotUndo:!0,exec:function(){var e=this.options.name+this.options.extension;".xlsx"===this.options.extension?this.options.workbook.saveAsExcel({fileName:e}):".pdf"===this.options.extension&&this.options.workbook.saveAsPDF(t.extend(this.options.pdf,{workbook:this.options.workbook,fileName:e}))}});var v=h.extend({init:function(e){h.fn.init.call(this,e),this._name=e.name,this._value=e.value},getState:function(){this._state=this._workbook.nameDefinition(this._name)},setState:function(){this._workbook.nameDefinition(this._name,this._state),this._workbook.trigger("change",{recalc:!0})}});e.spreadsheet.DefineNameCommand=v.extend({exec:function(){this.getState();try{this._workbook.defineName(this._name,this._value),this._workbook.trigger("change",{recalc:!0})}catch(e){return{title:"Error",body:e+"",reason:"error"}}}}),e.spreadsheet.DeleteNameCommand=v.extend({exec:function(){this.getState(),this._workbook.undefineName(this._name),this._workbook.trigger("change",{recalc:!0})}})}(kendo)})?n.apply(t,o):n)||(e.exports=r)},1598:function(e,t){e.exports=i(7643)},1599:function(e,t){e.exports=i(4203)}})},5104:(e,t,i)=>{e.exports=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}return i.m=e,i.c=t,i.p="",i(0)}({0:function(e,t,i){i(1600),e.exports=i(1600)},3:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},20:function(e,t){e.exports=i(1657)},1600:function(e,t,i){var n,o,r;i(3),o=[i(20)],void 0===(r="function"==typeof(n=function(){!function(e){"use strict";var t=e.jQuery,i=/:alphanum$/,n={up:"up",down:"down",left:"left",right:"right",home:"first-col",end:"last-col","ctrl+left":"word-left","ctrl+right":"word-right","ctrl+up":"word-up","ctrl+down":"word-down","ctrl+home":"first","ctrl+end":"last",pageup:"prev-page",pagedown:"next-page"},o={tab:"next","shift+tab":"previous",enter:"lower","shift+enter":"upper",delete:"clearContents",backspace:"clearContents","shift+:alphanum":"edit","alt+:alphanum":"edit",":alphanum":"edit","ctrl+:alphanum":"ctrl","alt+ctrl+:alphanum":"edit",":edit":"edit"},r={wheel:"onWheel","*+mousedown":"onMouseDown",contextmenu:"onContextMenu","*+mousedrag":"onMouseDrag","*+mouseup":"onMouseUp","*+dblclick":"onDblClick",mousemove:"onMouseMove"},a={pageup:"onPageUp",pagedown:"onPageDown",mouseup:"onMouseUp","*+cut":"onCut","*+paste":"onPaste","*+copy":"onCopy"},s={esc:"onEditorEsc",enter:"onEditorBlur","alt+enter":"insertNewline","shift+enter":"onEditorBlur",tab:"onEditorBlur","shift+tab":"onEditorBlur","shift+ctrl+enter":"onEditorArrayFormula"},h=t.extend({focus:"onEditorBarFocus"},s),c=t.extend({focus:"onEditorCellFocus"},s),l={cell:"range",rowheader:"row",columnheader:"column",topcorner:"sheet",autofill:"autofill"};function d(e){return e.map((function(e){return'[data-action="'+e+'"]'})).join(",")}var u=d(["cut","copy","paste","insert-left","insert-right","insert-above","insert-below"]),f=d(["unhide-row","unhide-column"]),p=[],g=[],v=[];for(var m in n)p.push(m),g.push("shift+"+m);for(m in o)v.push(m);a[p]="onAction",a[g]="onShiftAction",a[v]="onEntryAction",c[p]="onEditorAction",c[g]="onEditorShiftAction";var _=e.Class.extend({init:function(i,n){this.view=i,this.workbook(n),this.container=t(i.container),this.clipboardElement=t(i.clipboard),this.cellContextMenu=i.cellContextMenu,this.rowHeaderContextMenu=i.rowHeaderContextMenu,this.colHeaderContextMenu=i.colHeaderContextMenu,this.drawingContextMenu=i.drawingContextMenu,this.scroller=i.scroller,this.tabstrip=i.tabstrip,this.sheetsbar=i.sheetsbar,i.nameEditor.bind("enter",this.onNameEditorEnter.bind(this)),i.nameEditor.bind("cancel",this.onNameEditorCancel.bind(this)),i.nameEditor.bind("select",this.onNameEditorSelect.bind(this)),i.nameEditor.bind("delete",this.onNameEditorDelete.bind(this)),this.editor=i.editor,this.editor.bind("change",this.onEditorChange.bind(this)),this.editor.bind("activate",this.onEditorActivate.bind(this)),this.editor.bind("deactivate",this.onEditorDeactivate.bind(this)),this.editor.bind("update",this.onEditorUpdate.bind(this)),t(i.scroller).on("scroll",this.onScroll.bind(this)),this.listener=new e.spreadsheet.EventListener(this.container,this,r),t(i.scroller).on("mousedown",this.onMouseDown.bind(this)),this._enableEditorEvents(),this.sheetsbar&&(this.sheetsbar.bind("select",this.onSheetBarSelect.bind(this)),this.sheetsbar.bind("reorder",this.onSheetBarReorder.bind(this)),this.sheetsbar.bind("rename",this.onSheetBarRename.bind(this)),this.sheetsbar.bind("remove",this.onSheetBarRemove.bind(this))),this.cellContextMenu.bind("select",this.onContextMenuSelect.bind(this)),this.rowHeaderContextMenu.bind("select",this.onContextMenuSelect.bind(this)),this.colHeaderContextMenu.bind("select",this.onContextMenuSelect.bind(this)),this.drawingContextMenu.bind("select",this.onContextMenuSelect.bind(this)),this.cellContextMenu.element.add(this.rowHeaderContextMenu.element).add(this.colHeaderContextMenu.element).add(this.drawingContextMenu.element).on("contextmenu",!1),this.tabstrip&&(this.tabstrip.bind("action",this.onCommandRequest.bind(this)),this.tabstrip.bind("dialog",this.onDialogRequest.bind(this)))},_enableEditorEvents:function(t){void 0===t||t?(this.keyListener=new e.spreadsheet.EventListener(this.clipboardElement,this,a),this.barKeyListener=new e.spreadsheet.EventListener(this.editor.barElement(),this,h),this.inputKeyListener=new e.spreadsheet.EventListener(this.editor.cellElement(),this,c)):(this.keyListener.destroy(),this.barKeyListener.destroy(),this.inputKeyListener.destroy())},_execute:function(e){var t=this._workbook.execute(e);return"EditCommand"!==e.command||t||this._workbook.trigger("change",{editorClose:!0}),t&&(this._preventNavigation=!0,"error"===t.reason?(this.editor.deactivate(!0),this.view.showError(t,function(){this.activateEditor(!1),this.editor.value(this._lastEditorValue),this.editor._value=this._workbook._inputForRef(this._workbook.activeSheet()._viewActiveCell()),this.editor.select()}.bind(this))):this.view.openDialog(t.reason)),t},_activeTooltip:function(){return this._workbook.activeSheet().activeCell().simplify().toString()},onContextMenuSelect:function(e){var i;switch(t(e.item).data("action")){case"cut":i={command:"ToolbarCutCommand",options:{workbook:this._workbook}};break;case"copy":i={command:"ToolbarCopyCommand",options:{workbook:this._workbook}};break;case"paste":i={command:"ToolbarPasteCommand",options:{workbook:this._workbook}};break;case"delete-drawing":i={command:"DeleteDrawingCommand",options:{drawing:this.navigator._sheet._activeDrawing}};break;case"bring-to-front":i={command:"BringToFrontCommand",options:{drawing:this.navigator._sheet._activeDrawing}};break;case"send-to-back":i={command:"SendToBackCommand",options:{drawing:this.navigator._sheet._activeDrawing}};break;case"unmerge":i={command:"MergeCellCommand",options:{value:"unmerge"}};break;case"merge":this.view.openDialog("merge");break;case"hide-row":i={command:"HideLineCommand",options:{axis:"row"}};break;case"hide-column":i={command:"HideLineCommand",options:{axis:"column"}};break;case"unhide-row":i={command:"UnHideLineCommand",options:{axis:"row"}};break;case"unhide-column":i={command:"UnHideLineCommand",options:{axis:"column"}};break;case"delete-row":i={command:"DeleteRowCommand"};break;case"delete-column":i={command:"DeleteColumnCommand"}}i&&this._execute(i)},onSheetBarRemove:function(e){var t=this._workbook.sheetByName(e.name);t&&this._workbook.removeSheet(t)},destroy:function(){this.listener.destroy(),this._enableEditorEvents(!1),this.keyListener.destroy(),this.inputKeyListener.destroy()},onSheetBarSelect:function(e){var t,i=this._workbook;if(e.isAddButton){if(this._workbook.trigger("insertSheet"))return;t=i.insertSheet()}else t=i.sheetByName(e.name);if(i.activeSheet().name()!==t.name()){if(this._workbook.trigger("selectSheet",{sheet:t}))return;this.editor.canInsertRef(!1)||this.editor.deactivate(),i.activeSheet(t)}},onSheetBarReorder:function(e){var t=this._workbook,i=t.sheetByIndex(e.oldIndex),n=t.activeSheet(),o=n.name();if(t.moveSheetToIndex(i,e.newIndex),o!==i.name()){if(t.trigger("selectSheet",{sheet:i}))return void t.activeSheet(n);this.editor.canInsertRef(!1)||this.editor.deactivate(),t.activeSheet(i)}},onSheetBarRename:function(e){var t=this._workbook.sheetByIndex(e.sheetIndex);this._workbook.sheetByName(e.name)?this.view.showError({reason:"error",type:"duplicateSheetName"}):(this._workbook.renameSheet(t,e.name),this.clipboardElement.focus())},sheet:function(e){this.navigator=e.navigator(),this.axisManager=e.axisManager()},workbook:function(e){this._workbook=e,this.clipboard=e.clipboard(),e.bind("commandRequest",this.onCommandRequest.bind(this))},refresh:function(){var e=this.editor,t=this._workbook.activeSheet();this._viewPortHeight=this.view.scroller.clientHeight,this.navigator.height(this._viewPortHeight),e.isActive()||this.isEditorDisabled||(e.enable(!1!==t.selection().enable()),this.resetEditorValue());var i=t.selection()._ref.simplify(),n=this._workbook.nameForRef(i,t.name());this.view.nameEditor.value(n.name)},onScroll:function(){this.view.render({scroll:!0})},onWheel:function(e){var t=e.originalEvent.deltaX,i=e.originalEvent.deltaY;1===e.originalEvent.deltaMode&&(t*=10,i*=10),this.scrollWith(t,i),e.preventDefault()},onAction:function(e,t){this._workbook.activeSheet()._activeDrawing=null,this.navigator.moveActiveCell(n[t]),e.preventDefault()},onPageUp:function(){this.scrollDown(-this._viewPortHeight)},onPageDown:function(){this.scrollDown(this._viewPortHeight)},onEntryAction:function(e,t){var n=this._workbook.activeSheet();if(e.mod){var r=!0;switch(String.fromCharCode(e.keyCode)){case"A":n._activeDrawing=null,this.navigator.selectAll();break;case"Y":this._workbook.undoRedoStack.redo();break;case"Z":this._workbook.undoRedoStack.undo();break;default:r=!1}r&&e.preventDefault()}else{var a=!1===n.selection().enable(),s=":edit"!==t;if("delete"==t||"backspace"==t)n._activeDrawing?this._execute({command:"DeleteDrawingCommand",options:{drawing:n._activeDrawing}}):a||this._execute({command:"ClearContentCommand"}),e.preventDefault();else if(i.test(t)||!s){if(n._activeDrawing=null,a)return void e.preventDefault();s&&this.editor.value(""),this.activateEditor(s)}else this.navigator.navigateInSelection(o[t]),e.preventDefault()}},onShiftAction:function(e,t){this.navigator.modifySelection(n[t.replace("shift+","")],this.appendSelection),e.preventDefault()},onMouseMove:function(e){var t=this._workbook.activeSheet();if(!t.resizingInProgress()&&!t.selectionInProgress()){var i=this.objectAt(e);"columnresizehandle"===i.type||"rowresizehandle"===i.type?t.positionResizeHandle(i.ref):t.removeResizeHandle(),t._renderComment("cell"==i.type?i.ref:null)}},onMouseDown:function(t){var i=this.objectAt(t);if(i.pane&&(this.originFrame=i.pane),this._startResizingDrawing(t,i))t.stopPropagation();else{var n=this._workbook.activeSheet(),o=this.container.closest('[data-role="window"]');if(o.length&&(o=e.widgetInstance(o))&&o.options.modal&&t.stopPropagation(),n._activeDrawing=null,"drawing"===i.type)return n._activeDrawing=i.drawing,i.copy=i.drawing.clone(),i.startBox=n.drawingBoundingBox(i.copy),n.startDragging(i),n.triggerChange({dragging:!0}),void t.preventDefault();if("editor"===i.type)return this.onEditorEsc(),this.openCustomEditor(),void t.preventDefault();if(this.editor.canInsertRef(!1)&&i.ref)return this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs()),this.navigator.startSelection(i.ref,this._selectionMode,this.appendSelection,t.shiftKey,this.view),void t.preventDefault();if(this._preventNavigation=!1,this.editor.deactivate(),!this._preventNavigation){if("columnresizehandle"===i.type||"rowresizehandle"===i.type)return n.startResizing({x:i.x,y:i.y}),void t.preventDefault();if("filtericon"===i.type)return this.openFilterMenu(t),void t.preventDefault();this._selectionMode=l[i.type],this.appendSelection=t.mod,this.navigator.startSelection(i.ref,this._selectionMode,this.appendSelection,t.shiftKey,this.view)}}},_startResizingDrawing:function(e){var i=t(e.target).closest(".k-spreadsheet-drawing-handle");if(i.length){var n=this.translateCoords(e),o=i.data("direction"),r=this._workbook.activeSheet(),a=r._activeDrawing;return r.startDragging({pane:this.originFrame,drawing:a,copy:a.clone(),startBox:r.drawingBoundingBox(a),resize:o,startX:n.x,startY:n.y}),!0}},onContextMenu:function(t){var i=this._workbook.activeSheet();if(t.preventDefault(),!i.resizingInProgress()&&!i.draggingInProgress()){var n;this.cellContextMenu.close(),this.colHeaderContextMenu.close(),this.rowHeaderContextMenu.close(),this.drawingContextMenu.close();var o=this.objectAt(t);if("columnresizehandle"!==o.type&&"rowresizehandle"!==o.type){o.ref?this.navigator.selectForContextMenu(o.ref,l[o.type]):"drawing"==o.type&&this.navigator.selectDrawingForContextMenu(o.drawing);var r=this.navigator._sheet.select()instanceof e.spreadsheet.UnionRef,a=!1,s=!1;"columnheader"==o.type?(n=this.colHeaderContextMenu,a=!r&&this.axisManager.selectionIncludesHiddenColumns()):"rowheader"==o.type?(n=this.rowHeaderContextMenu,a=!r&&this.axisManager.selectionIncludesHiddenRows()):"drawing"==o.type?n=this.drawingContextMenu:(n=this.cellContextMenu,s=this.navigator.selectionIncludesMergedCells()),n.element.find(u).toggle(!r),n.element.find(f).toggle(a),n.element.find("[data-action=unmerge]").toggle(s),setTimeout((function(){n.open(t.pageX,t.pageY)}))}}},prevent:function(e){e.preventDefault()},constrainResize:function(e,t){var i=this._workbook.activeSheet().resizeHandlePosition();return!i||"outside"===e||"topcorner"===e||t.col<i.col||t.row<i.row},_dragDrawing:function(e){var t=this._workbook.activeSheet(),i=t.draggingInProgress();if(!i)return!1;var n=this.translateCoords(e),o=i.drawing,r=n.x-i.startX,a=n.y-i.startY;return"SE"==i.resize?i.aspect?Math.abs(r)>Math.abs(a)?(o.width=Math.max(i.copy.width+r,20),o.height=o.width/i.aspect):(o.height=Math.max(i.copy.height+a,20),o.width=o.height*i.aspect):(o.width=Math.max(i.copy.width+r,20),o.height=Math.max(i.copy.height+a,20)):"E"==i.resize?o.width=Math.max(i.copy.width+r,20):"S"==i.resize?o.height=Math.max(i.copy.height+a,20):"N"==i.resize?i.copy.height-a>20&&(o.height=i.copy.height-a,o.offsetY=i.copy.offsetY+a):"W"==i.resize?i.copy.width-r>20&&(o.width=i.copy.width-r,o.offsetX=i.copy.offsetX+r):"NE"==i.resize?(o.width=Math.max(i.copy.width+r,20),i.copy.height-a>20&&(o.height=i.copy.height-a,o.offsetY=i.copy.offsetY+a)):"SW"==i.resize?(o.height=Math.max(i.copy.height+a,20),i.copy.width-r>20&&(o.width=i.copy.width-r,o.offsetX=i.copy.offsetX+r)):"NW"==i.resize?(i.copy.height-a>20&&(o.height=i.copy.height-a,o.offsetY=i.copy.offsetY+a),i.copy.width-r>20&&(o.width=i.copy.width-r,o.offsetX=i.copy.offsetX+r)):(o.offsetX=i.copy.offsetX+r,o.offsetY=i.copy.offsetY+a),t.triggerChange({dragging:!0}),!0},onMouseDrag:function(t){if("sheet"!==this._selectionMode){var i={clientX:t.clientX,clientY:t.clientY},n=this._workbook.activeSheet();if(!this._dragDrawing(t)){var o=this.objectAt(i);if(n.resizingInProgress())this.constrainResize(o.type,o.ref)||n.resizeHintPosition({x:o.x,y:o.y});else if("outside"!==o.type){if(this.originFrame===o.pane)this.selectToLocation(i);else{var r=this.originFrame._grid;o.x>r.right&&e.scrollLeft(this),o.y>r.bottom&&this.scrollTop(),o.y<r.top||o.x<r.left?this.startAutoScroll(o,i):this.selectToLocation(i)}t.preventDefault()}else this.startAutoScroll(o)}}},onMouseUp:function(e){var t=this._workbook.activeSheet();t.completeResizing(),t.completeDragging(),this.navigator.completeSelection(),this.stopAutoScroll();var i=this.editor.activeEditor();if(i){for(var n=e.target;n;){if(n===i.element[0])return;n=n.parentNode}var o=this.objectAt(e);o&&o.ref&&i.canInsertRef(!1)&&(i.refAtPoint(t),t._setFormulaSelections(i.highlightedRefs()))}},onDblClick:function(e){var t=this.objectAt(e),i=!1===this._workbook.activeSheet().selection().enable();if("cell"===t.type&&!i){var n=this._workbook.activeSheet().selection();this.activateEditor(!n.value()&&!n.formula()),this.onEditorUpdate()}},onCut:function(e){var t=this;setTimeout((function(){t.clipboard.menuInvoked=void 0===e,t._execute({command:"CutCommand",options:{workbook:t.view._workbook,event:e.originalEvent||e}})}))},clipBoardValue:function(){return this.clipboardElement.html()},_pasteImage:function(e){var t=this,i=new window.Image;i.src=window.URL.createObjectURL(e),i.onload=function(){t._execute({command:"InsertImageCommand",options:{blob:e,width:i.width,height:i.height}})},setTimeout((function(){window.URL.revokeObjectURL(i.src)}),10)},onPaste:function(t){var i=this,n="",o="";if(i.clipboard.menuInvoked=void 0===t,t){var r=t.originalEvent.clipboardData;if(!r||!r.getData){if(window.clipboardData.files&&window.clipboardData.files.length){var a=window.clipboardData.files[0];if(/^image\/(?:png|jpe?g|gif)$/i.test(a.type))return i._pasteImage(a)}return(o=window.clipboardData.getData("Text"))&&(o=o.trim()),i.clipboardElement.empty(),void setTimeout((function(){((n=i.clipboardElement.html())||o)&&(i.clipboard.external({html:n,plain:o}),i._execute({command:"PasteCommand",options:{workbook:i.view._workbook,event:t.originalEvent||t}}))}))}t.preventDefault();var s=!1,h=!1;if(window.DOMStringList&&r.types instanceof window.DOMStringList?(s=r.types.contains("text/html"),h=r.types.contains("text/plain")):Array.isArray(r.types)?(s=r.types.indexOf("text/html")>=0,h=r.types.indexOf("text/plain")>=0):(s=/text\/html/.test(r.types),h=/text\/plain/.test(r.types)),s&&(n=r.getData("text/html").trim()),h&&(o=r.getData("text/plain").trim()),!n&&!o&&r.items&&r.items.length)for(var c=0;c<r.items.length;++c){var l=r.items[c];if("file"==l.kind&&/^image\/(?:png|jpe?g|gif)$/i.test(l.type))return i._pasteImage(l.getAsFile())}}else{if(e.support.browser.msie)return i.clipboardElement.focus().select(),void document.execCommand("paste");i.clipboard.menuInvoked=!0}(n||o)&&(i.clipboard.external({html:n,plain:o}),i._execute({command:"PasteCommand",options:{workbook:i.view._workbook,event:t.originalEvent||t}}))},onCopy:function(e){this.clipboard.menuInvoked=void 0===e,this._execute({command:"CopyCommand",options:{workbook:this.view._workbook,event:e.originalEvent||e}})},scrollTop:function(){this.scroller.scrollTop=0},scrollLeft:function(){this.scroller.scrollLeft=0},scrollDown:function(e){this.scroller.scrollTop+=e},scrollRight:function(e){this.scroller.scrollLeft+=e},scrollWith:function(e,t){this.scroller.scrollTop+=t,this.scroller.scrollLeft+=e},translateCoords:function(e){var t=this.container[0].getBoundingClientRect();return{x:e.clientX-t.left,y:e.clientY-t.top}},objectAt:function(e,t){if(e)return e=this.translateCoords(e),this.view.objectAt(e.x,e.y,t)},selectToLocation:function(e){var t=this.objectAt(e,!0);t.pane&&t.ref&&(this.extendSelection(t),this.lastKnownCellLocation=e,this.originFrame=t.pane),this.stopAutoScroll()},extendSelection:function(e){this.navigator.extendSelection(e.ref,this._selectionMode)},autoScroll:function(){var e=this._autoScrollTarget.x,t=this._autoScrollTarget.y,i=this.originFrame._grid,n=this.view.scroller,o=n.scrollLeft,r=n.scrollTop;e<i.left&&this.scrollRight(-8),e>i.right&&this.scrollRight(8),t<i.top&&this.scrollDown(-8),t>i.bottom&&this.scrollDown(8),r===n.scrollTop&&o===n.scrollLeft?this.selectToLocation(this.finalLocation):this.extendSelection(this.objectAt(this.lastKnownCellLocation))},startAutoScroll:function(e,t){this._scrollInterval||(this._scrollInterval=setInterval(this.autoScroll.bind(this),50)),this.finalLocation=t||this.lastKnownCellLocation,this._autoScrollTarget=e},stopAutoScroll:function(){clearInterval(this._scrollInterval),this._scrollInterval=null},openCustomEditor:function(){this.view.openCustomEditor()},openFilterMenu:function(e){var t=this.objectAt(e),i=this._workbook.activeSheet().filterColumn(t.ref),n=this.view.createFilterMenu(i);n.bind("action",this.onCommandRequest.bind(this)),n.bind("action",n.close.bind(n)),n.openFor(e.target)},_saveEditorValue:function(e){var t=this.editor._range.sheet(),i=this.editor.value();this._workbook.activeSheet()!==t&&(this._workbook.activeSheet()._setFormulaSelections(),this._workbook.activeSheet(t)),t.isInEditMode(!1),this._lastEditorValue=i,this._execute({command:"EditCommand",options:{value:i,arrayFormula:e}})},onEditorChange:function(){this._saveEditorValue(!1)},onEditorArrayFormula:function(){this._saveEditorValue(!0),this.editor.deactivate(!0)},onEditorActivate:function(){var e=this._workbook.activeSheet();e._setFormulaSelections(this.editor.highlightedRefs()),e.isInEditMode(!0)},onEditorDeactivate:function(){var e=this._workbook.activeSheet();e.isInEditMode(!1),e._setFormulaSelections([])},onEditorUpdate:function(){this._workbook.activeSheet()._setFormulaSelections(this.editor.highlightedRefs())},onEditorBarFocus:function(){!1===this._workbook.activeSheet().selection().enable()||this.editor.activate({range:this._workbook.activeSheet().selection(),rect:this.view.activeCellRectangle(),tooltip:this._activeTooltip()})},onEditorCellFocus:function(){this.editor.scale()},onEditorEsc:function(){this.resetEditorValue(),this.editor.deactivate(),this.clipboardElement.focus()},insertNewline:function(e){e.preventDefault(),this.editor.insertNewline()},onEditorBlur:function(e,t){this.editor.isFiltered()||(this._preventNavigation=!1,this.editor.deactivate(),this._preventNavigation||(this.clipboardElement.focus(),this.navigator.navigateInSelection(o[t])))},onEditorAction:function(e,t){var i=this.editor,o=this._workbook.activeSheet();this._casualEditing&&/^(?:up|right|down|left)$/.test(t)?(this.deactivateEditor(),this.navigator.moveActiveCell(n[t]),e.preventDefault()):i.canInsertRef(!0)&&(this.navigator.moveActiveCell(n[t]),i.activeEditor().refAtPoint(o),o._setFormulaSelections(i.highlightedRefs()),e.preventDefault())},onEditorShiftAction:function(e,t){var i=this.editor,o=this._workbook.activeSheet();i.canInsertRef(!0)&&(this.navigator.modifySelection(n[t.replace("shift+","")],this.appendSelection),i.activeEditor().refAtPoint(o),o._setFormulaSelections(i.highlightedRefs()),e.preventDefault())},resetEditorValue:function(){var e=this._workbook.activeSheet(),t=e.activeCell(),i=this._workbook._inputForRef(t),n=e.range(t).intersectingArrayFormula();n&&(i="="+n.formula),this.editor.value(i,!!n)},activateEditor:function(e){this._casualEditing=e,this.editor.activate({range:this._workbook.activeSheet().selection(),rect:this.view.activeCellRectangle(),tooltip:this._activeTooltip()}).focus()},deactivateEditor:function(){this.view.editor.deactivate()},onCommandRequest:function(e){e.command?this._execute(e):this._workbook.undoRedoStack[e.action]()},onDialogRequest:function(e){var i={pdfExport:this._workbook.options.pdf,excelExport:this._workbook.options.excel};e.options?t.extend(!0,e.options,i):e.options=i,this.view.openDialog(e.name,e.options)},onNameEditorEnter:function(){var t,i=this._workbook,n=i.activeSheet(),o=this.view.nameEditor.value();if((t=e.spreadsheet.calc.parseReference(o,!0)||i.nameValue(o))instanceof e.spreadsheet.Ref){if(t.sheet&&t.sheet.toLowerCase()!=n.name().toLowerCase()){var r=i.sheetByName(t.sheet);r&&(i.activeSheet(r),n=r)}n.range(t).select()}else t=n.selection()._ref.clone().simplify().setSheet(n.name(),!0),this._execute({command:"DefineNameCommand",options:{name:o,value:t}}),this.clipboardElement.focus()},onNameEditorCancel:function(){this.clipboardElement.focus()},onNameEditorSelect:function(t){var i=t.name,n=this._workbook,o=n.activeSheet(),r=n.nameValue(i);if(r instanceof e.spreadsheet.Ref){if(r.sheet&&r.sheet.toLowerCase()!=o.name().toLowerCase()){var a=n.sheetByName(r.sheet);a&&(n.activeSheet(a),o=a)}o.range(r).select()}else this.clipboardElement.focus()},onNameEditorDelete:function(e){this._execute({command:"DeleteNameCommand",options:{name:e.name}}),this.clipboardElement.focus()}});e.spreadsheet.Controller=_}(window.kendo)})?n.apply(t,o):n)||(e.exports=r)}})},833:(e,t,i)=>{e.exports=function(e){var t={};function i(n){if(t[n])return t[n].exports;var o=t[n]={exports:{},id:n,loaded:!1};return e[n].call(o.exports,o,o.exports,i),o.loaded=!0,o.exports}return i.m=e,i.c=t,i.p="",i(0)}({0:function(e,t,i){i(1601),e.exports=i(1601)},3:function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},20:function(e,t){e.exports=i(1657)},953:function(e,t){e.exports=i(3261)},1033:function(e,t){e.exports=i(1693)},1601:function(e,t,i){var n,o,r;i(3),o=[i(20),i(953),i(1602),i(1033),i(1603)],void 0===(r="function"==typeof(n=function(){!function(e){"use strict";var t=e.jQuery,i={},n=e.spreadsheet.registerEditor=function(e,t){i[e]=t};e.spreadsheet.Sheet.prototype.activeCellCustomEditor=function(){var e=this.activeCell().first();if(this.range(e).enable()){var t,n=this.validation(e),o=this._properties.get("editor",this._grid.cellRefIndex(e));return null!=o?t=i[o]:n&&n.showButton&&(o="_validation_"+n.dataType,t=i[o]),"function"==typeof t&&(t=i[o]=t()),t}},n("_validation_date",(function(){var i,n,o;function r(){n||(n=t("<div>").kendoCalendar(),o=t("<div>").kendoPopup(),n.appendTo(o),n=n.getKendoCalendar(),o=o.getKendoPopup(),n.bind("change",(function(){o.close();var t=n.value();i.range.format()||i.range.format("yyyy-mm-dd"),i.callback(e.spreadsheet.dateToNumber(t))}))),o.setOptions({anchor:i.view.element.find(".k-spreadsheet-editor-button")});var r=i.range.value(),s=i.range.sheet();null!=r?n.value(e.spreadsheet.numberToDate(r)):n.value(null);var h=i.validation;if(h){var c=e.ui.Calendar.fn.options.min,l=e.ui.Calendar.fn.options.max,d=h.from,u=h.to,f=e.spreadsheet.calc.runtime.Formula;/^(?:greaterThan|between)/.test(h.comparerType)&&(c=d instanceof f&&a(d.value)?e.spreadsheet.numberToDate(s.range(d.value.row,d.value.col).value()):e.spreadsheet.numberToDate(d.value)),"between"==h.comparerType&&(l=u instanceof f&&a(u.value)?e.spreadsheet.numberToDate(s.range(u.value.row,u.value.col).value()):e.spreadsheet.numberToDate(h.to.value)),"lessThan"!=h.comparerType&&"lessThanOrEqualTo"!=h.comparerType||(l=d instanceof f&&a(d.value)?e.spreadsheet.numberToDate(s.range(d.value.row,d.value.col).value()):e.spreadsheet.numberToDate(h.from.value)),n.setOptions({disableDates:function(t){var i,n;return i=d&&d instanceof f&&a(d.value)?s.range(d.value.row,d.value.col).value():d?0|d.value:0,n=u&&u instanceof f&&a(u.value)?s.range(u.value.row,u.value.col).value():u?0|u.value:0,t=0|e.spreadsheet.dateToNumber(t),!e.spreadsheet.validation.validationComparers[h.comparerType](t,i,n)},min:c,max:l})}else n.setOptions({disableDates:null,min:null,max:null});o.open()}function a(e){return e&&null!==e.row&&null!==e.col&&e.row>-1&&e.col>-1}return{edit:function(e){i=e,r()},icon:"k-i-calendar"}})),n("_validation_list",(function(){var i,n,o;function r(){n||(n=t("<ul class='k-list k-reset'/>").kendoStaticList({template:"#:value#",selectable:!0,autoBind:!1}),o=t("<div class='k-spreadsheet-list-popup'>").kendoPopup(),n.appendTo(o),o=o.getKendoPopup(),(n=n.getKendoStaticList()).bind("change",(function(){o.close();var e=n.value()[0];e&&i.callback(e.value)}))),o.setOptions({anchor:i.view.element.find(".k-spreadsheet-editor-button")});var r=i.validation.from.value,a=[],s=function(e){a.push({value:e})};r instanceof e.spreadsheet.calc.runtime.Matrix?r.each(s):(r+"").split(/\s*,\s*/).forEach(s);var h=new e.data.DataSource({data:a});n.setDataSource(h),h.read(),o.open()}return{edit:function(e){i=e,r()},icon:"k-i-arrow-60-down"}}))}(window.kendo)})?n.apply(t,o):n)||(e.exports=r)},1602:function(e,t){e.exports=i(9188)},1603:function(e,t){e.exports=i(6958)}})}}]);